<html>
<head>
<title>TestInstall.cxx</title>
</head>
<body bgcolor="#ffffff">
<pre><a name="anchor-0"></a>
/*
	Copyright (c) 2024 PTC Inc. and/or Its Subsidiary Companies. All Rights Reserved.
*/

<a name="anchor-1"></a>
/*--------------------------------------------------------------------*\
Application includes
\*--------------------------------------------------------------------*/
#include &lt;time.h>
<a name="anchor-2"></a># include &lt;iostream>
using namespace std;
#include &quot;TestError.h&quot;

/*--------------------------------------------------------------------*\
<a name="anchor-3"></a>Pro/Toolkit includes
\*--------------------------------------------------------------------*/

#include &lt;ProToolkit.h>
#include &lt;Pro2dEntdef.h>
<a name="anchor-4"></a>#include &lt;ProANSI.h>
#include &lt;ProAnalysis.h>
#include &lt;ProAnimate.h>
#include &lt;ProArray.h>
#include &lt;ProAsmcomp.h>
<a name="anchor-5"></a>#include &lt;ProAsmcomppath.h>
#include &lt;ProAssembly.h>
#include &lt;ProAutodrill.h>
#include &lt;ProAxis.h>
#include &lt;ProCabling.h>
<a name="anchor-6"></a>#include &lt;ProCavitylayout.h>
#include &lt;ProCavlayrule.h>
#include &lt;ProChamfer.h>
#include &lt;ProClCmd.h>
#include &lt;ProClcmdElem.h>
<a name="anchor-7"></a>#include &lt;ProCollect.h>
#include &lt;ProColor.h>
#include &lt;ProComm.h>
#include &lt;ProConst.h>
#include &lt;ProContour.h>
<a name="anchor-8"></a>#include &lt;ProContourdata.h>
#include &lt;ProCopyGeom.h>
#include &lt;ProCore.h>
#include &lt;ProCsys.h>
#include &lt;ProCsysdata.h>
<a name="anchor-9"></a>#include &lt;ProCurve.h>
#include &lt;ProCurvedata.h>
#include &lt;ProDatumdata.h>
#include &lt;ProDimension.h>
#include &lt;ProDisplist.h>
<a name="anchor-10"></a>#include &lt;ProDrawing.h>
#include &lt;ProDtlattach.h>
#include &lt;ProDtlentity.h>
#include &lt;ProDtlgroup.h>
#include &lt;ProDtlitem.h>
<a name="anchor-11"></a>#include &lt;ProDtlnote.h>
#include &lt;ProDtlsymdef.h>
#include &lt;ProDtlsyminst.h>
#include &lt;ProDtmAxis.h>
#include &lt;ProDtmCrv.h>
<a name="anchor-12"></a>#include &lt;ProDtmCrvSketch.h>
#include &lt;ProDtmCsys.h>
#include &lt;ProDtmPln.h>
#include &lt;ProDtmPnt.h>
#include &lt;ProDwgtable.h>
<a name="anchor-13"></a>#include &lt;ProEdge.h>
#include &lt;ProEdgedata.h>
#include &lt;ProElemId.h>
#include &lt;ProElement.h>
#include &lt;ProElempath.h>
<a name="anchor-14"></a>#include &lt;ProExpldstate.h>
#include &lt;ProExtdata.h>
#include &lt;ProExtobj.h>
#include &lt;ProExtobjCB.h>
#include &lt;ProExtobjDisp.h>
<a name="anchor-15"></a>#include &lt;ProExtobjRef.h>
#include &lt;ProExtobjSel.h>
#include &lt;ProExtrude.h>
#include &lt;ProFaminstance.h>
#include &lt;ProFamtable.h>
<a name="anchor-16"></a>#include &lt;ProFeatForm.h>
#include &lt;ProFeatIntr.h>
#include &lt;ProFeatType.h>
#include &lt;ProFeature.h>
#include &lt;ProFemMesh.h>
<a name="anchor-17"></a>#include &lt;ProFemObjects.h>
#include &lt;ProFlatSrf.h>
#include &lt;ProForeignCurve.h>
#include &lt;ProGeomitem.h>
#include &lt;ProGeomitemdata.h>
<a name="anchor-18"></a>#include &lt;ProGraphic.h>
#include &lt;ProGroup.h>
#include &lt;ProGtol.h>
#include &lt;ProHardware.h>
#include &lt;ProHole.h>
<a name="anchor-19"></a>#include &lt;ProImm.h>
#include &lt;ProImportfeat.h>
#include &lt;ProIntf3Dexport.h>
#include &lt;ProIntfData.h>
#include &lt;ProIntfimport.h>
<a name="anchor-20"></a>#include &lt;ProItemerr.h>
#include &lt;ProJlink.h>
#include &lt;ProLayer.h>
#include &lt;ProMaterial.h>
#include &lt;ProMdl.h>
<a name="anchor-21"></a>#include &lt;ProMdlChk.h>
#include &lt;ProMenu.h>
#include &lt;ProMenuBar.h>
#include &lt;ProMessage.h>
#include &lt;ProMfg.h>
<a name="anchor-22"></a>#include &lt;ProMfgdb.h>
#include &lt;ProMfgoper.h>
#include &lt;ProModFeat.h>
#include &lt;ProMode.h>
#include &lt;ProModelitem.h>
<a name="anchor-23"></a>#include &lt;ProMoldbase.h>
#include &lt;ProNcseq.h>
#include &lt;ProNcseqElem.h>
#include &lt;ProNote.h>
#include &lt;ProNotify.h>
<a name="anchor-24"></a>#include &lt;ProObjects.h>
#include &lt;ProParameter.h>
#include &lt;ProParamval.h>
#include &lt;ProPart.h>
#include &lt;ProPattern.h>
<a name="anchor-25"></a>#include &lt;ProPecktable.h>
#include &lt;ProPiping.h>
#include &lt;ProPoint.h>
#include &lt;ProPrint.h>
#include &lt;ProProcstep.h>
<a name="anchor-26"></a>#include &lt;ProQuilt.h>
#include &lt;ProQuiltdata.h>
#include &lt;ProRefInfo.h>
#include &lt;ProRelSet.h>
#include &lt;ProReplace.h>
<a name="anchor-27"></a>#include &lt;ProRevolve.h>
#include &lt;ProRib.h>
#include &lt;ProRmdt.h>
#include &lt;ProRule.h>
#include &lt;ProScope.h>
<a name="anchor-28"></a>#include &lt;ProSecConstr.h>
#include &lt;ProSecdim.h>
#include &lt;ProSecdimType.h>
#include &lt;ProSecerror.h>
#include &lt;ProSection.h>
<a name="anchor-29"></a>#include &lt;ProSelection.h>
#include &lt;ProSheetmetal.h>
#include &lt;ProShrinkwrap.h>
#include &lt;ProSimprep.h>
#include &lt;ProSimprepdata.h>
<a name="anchor-30"></a>#include &lt;ProSizeConst.h>
#include &lt;ProSkeleton.h>
#include &lt;ProSolid.h>
#include &lt;ProStdSection.h>
#include &lt;ProSurface.h>
<a name="anchor-31"></a>#include &lt;ProSurfacedata.h>
#include &lt;ProSweep.h>
#include &lt;ProTool.h>
#include &lt;ProToolElem.h>
#include &lt;ProToolinput.h>
<a name="anchor-32"></a>#include &lt;ProToolkitDll.h>
#include &lt;ProUI.h>
#include &lt;ProUICascadebutton.h>
#include &lt;ProUICheckbutton.h>
#include &lt;ProUICmd.h>
<a name="anchor-33"></a>#include &lt;ProUIDialog.h>
#include &lt;ProUIInputpanel.h>
#include &lt;ProUILabel.h>
#include &lt;ProUILayout.h>
#include &lt;ProUIList.h>
<a name="anchor-34"></a>#include &lt;ProUIMenubar.h>
#include &lt;ProUIMenupane.h>
#include &lt;ProUIMessage.h>
#include &lt;ProUIOptionmenu.h>
#include &lt;ProUIProgressbar.h>
<a name="anchor-35"></a>#include &lt;ProUIPushbutton.h>
#include &lt;ProUIRadiogroup.h>
#include &lt;ProUISlider.h>
#include &lt;ProUISpinbox.h>
#include &lt;ProUITab.h>
<a name="anchor-36"></a>#include &lt;ProUITable.h>
#include &lt;ProUITextarea.h>
#include &lt;ProUIThumbwheel.h>
#include &lt;ProUdf.h>
#include &lt;ProUtil.h>
<a name="anchor-37"></a>#include &lt;ProUvStat.h>
#include &lt;ProValue.h>
#include &lt;ProVerstamp.h>
#include &lt;ProView.h>
#include &lt;ProWcell.h>
<a name="anchor-38"></a>#include &lt;ProWchar.h>
#include &lt;ProWeld.h>
#include &lt;ProWindows.h>
#include &lt;ProWorkspace.h>
#include &lt;ProWstring.h>
<a name="anchor-39"></a>#include &lt;ProXsec.h>
#include &lt;ProTKRunTime.h>
/*--------------------------------------------------------------------*\
Application global/external data
\*--------------------------------------------------------------------*/
<a name="anchor-40"></a>static wchar_t  MSGFIL[] = {'m','s','g','_','u','s','e','r','.','t','x','t','\0'};
static char revcode[PRO_LINE_SIZE];

/* Declare function */
ProError ProTestInstallationCheck();
<a name="anchor-41"></a>ProError ProTestInstallationURLCheck();
ProError  ProTestDialogCreate ( ProBoolean is_successful );

static uiCmdAccessState TestAccessDefault(uiCmdAccessMode access_mode)
{
<a name="anchor-42"></a>    return (ACCESS_AVAILABLE);
}


/*===========================================================================*\
<a name="anchor-43"></a>  Function : main
  Purpose  : Test the ProToolkitMain() function. main is optional function.
\*===========================================================================*/
int main(int argc, char **argv)
{
<a name="anchor-44"></a>    cerr &lt;&lt; endl &lt;&lt; &quot;\tWelcome to Pro/TOOLKIT  -  The \&quot;pt_install_test\&quot; program&quot; &lt;&lt; endl;

    ProToolkitMain(argc, argv);

    return(0);
<a name="anchor-45"></a>}


/*====================================================================*\
FUNCTION : user_initialize()
<a name="anchor-46"></a>PURPOSE  : Pro/DEVELOP standard initialize - define menu button
\*====================================================================*/
extern &quot;C&quot; int user_initialize(
    int argc,			
    char *argv[],
<a name="anchor-47"></a>    char *version, 
    char *build,
    wchar_t errbuf[80])
{
    char cbuff1[PRO_PATH_SIZE], cbuff2[PRO_PATH_SIZE];
<a name="anchor-48"></a>    char astr1[PRO_LINE_SIZE];
    int i, menu_id;
    ProPath wbuff1, wbuff2;
    ProError status;
    uiCmdCmdId	cmd_id;
<a name="anchor-49"></a>
    
    ProUITranslationFilesEnable();

/*---------------------------------------------------------------------*\
<a name="anchor-50"></a>   Loging file open. 
\*---------------------------------------------------------------------*/
    if ( argc > 4 )
      ProTestErrlogOpen(argv[4], version, build);
    else
<a name="anchor-51"></a>      ProTestErrlogOpen(&quot;pt_install_cxx&quot;, version, build);

/*---------------------------------------------------------------------*\
    First confirm the size of wchar_t
\*---------------------------------------------------------------------*/
<a name="anchor-52"></a>    status = ProWcharSizeVerify (sizeof (wchar_t), &amp;i);
    TEST_CALL_REPORT(&quot;ProWcharSizeVerify&quot;, &quot;user_initialize&quot;,
                      status, status != PRO_TK_NO_ERROR);

    if ( status != PRO_TK_NO_ERROR || (i != sizeof (wchar_t)) )
<a name="anchor-53"></a>    {
         ProTKSprintf(astr1,&quot;ERROR wchar_t Incorrect size (%d). Should be: %d&quot;,
		sizeof(wchar_t), i );
         status = ProMessageDisplay(MSGFIL, &quot;USER %0s&quot;, astr1);
         TEST_CALL_REPORT(&quot;ProMessageDisplay&quot;, &quot;user_initialize&quot;,
<a name="anchor-54"></a>                           status, status != PRO_TK_NO_ERROR);

	 cout &lt;&lt; astr1 &lt;&lt; endl;
	 ProStringToWstring(errbuf, astr1);
	 return(-1);
<a name="anchor-55"></a>    }

/*---------------------------------------------------------------------*\
    Add new button to the menu bar
\*---------------------------------------------------------------------*/
<a name="anchor-56"></a>    ProTKSprintf(revcode, &quot;%s - %s&quot;, version, build);

    /* Load any menu files into memory  */
     status = ProCmdActionAdd(&quot;-Install Test&quot;,
        (uiCmdCmdActFn)ProTestInstallationCheck,
<a name="anchor-57"></a>        uiProe2ndImmediate, TestAccessDefault,
        PRO_B_TRUE, PRO_B_TRUE, &amp;cmd_id);
    TEST_CALL_REPORT(&quot;ProCmdActionAdd&quot;, &quot;user_initialize&quot;,
                      status, status != PRO_TK_NO_ERROR);
 
<a name="anchor-58"></a>    status = ProMenubarmenuPushbuttonAdd(
	&quot;File&quot;, &quot;-Install Test&quot;, &quot;-Install Test Label&quot;, &quot;Install Test Help&quot;,
	&quot;File.psh_rename&quot;, PRO_B_TRUE, cmd_id, MSGFIL);
    TEST_CALL_REPORT(&quot;ProMenubarmenuPushbuttonAdd&quot;, &quot;user_initialize&quot;,
                      status, status != PRO_TK_NO_ERROR);
<a name="anchor-59"></a>
/*---------------------------------------------------------------------*\
    New Button for URL in Embedded Browser 
\*---------------------------------------------------------------------*/

<a name="anchor-60"></a>    status = ProCmdActionAdd(&quot;TOOLKIT Compilers&quot;,
	(uiCmdCmdActFn)ProTestInstallationURLCheck,
	uiProe2ndImmediate, TestAccessDefault,
	PRO_B_TRUE, PRO_B_TRUE, &amp;cmd_id);
    TEST_CALL_REPORT(&quot;ProCmdActionAdd&quot;, &quot;user_initialize&quot;,
<a name="anchor-61"></a>                      status, status != PRO_TK_NO_ERROR);

    status = ProMenubarmenuPushbuttonAdd( &quot;Help&quot;,
	&quot;TOOLKIT Compilers&quot;, &quot;Creo Parametric TOOLKIT Compilers Label&quot;, &quot;Creo Parametric TOOLKIT Compilers Help&quot;,
	NULL, PRO_B_TRUE, /* Always add at the bottom of the Help Menubar */ 
<a name="anchor-62"></a>	cmd_id, MSGFIL);

    TEST_CALL_REPORT(&quot;ProMenubarmenuPushbuttonAdd&quot;, &quot;user_initialize&quot;,
                      status, status != PRO_TK_NO_ERROR);

<a name="anchor-63"></a>/*---------------------------------------------------------------------*\
    Print the protk.dat  info
\*---------------------------------------------------------------------*/

    status = ProToolkitApplExecPathGet(wbuff1);
<a name="anchor-64"></a>    TEST_CALL_REPORT(&quot;ProToolkitApplExecPathGet&quot;, &quot;user_initialize&quot;,
                      status, status != PRO_TK_NO_ERROR);

    status = ProToolkitApplTextPathGet(wbuff2);
    TEST_CALL_REPORT(&quot;ProToolkitApplTextPathGet&quot;, &quot;user_initialize&quot;,
<a name="anchor-65"></a>                      status, status != PRO_TK_NO_ERROR);

    ProWstringToString(cbuff1, wbuff1);
    ProWstringToString(cbuff2, wbuff2);
    cout &lt;&lt; endl &lt;&lt; &quot;     Exec_path:  &quot; &lt;&lt; cbuff1 &lt;&lt;endl;
<a name="anchor-66"></a>    cout &lt;&lt; &quot;     Text_path:  &quot; &lt;&lt; cbuff2 &lt;&lt; endl &lt;&lt; endl;

    for(i=0; i&lt;argc; i++)
        cout &lt;&lt; &quot;   argv[&quot; &lt;&lt; i &lt;&lt; &quot;]: &quot; &lt;&lt; argv[i] &lt;&lt; endl;

<a name="anchor-67"></a>    /* Upon success */
    return (0);

#if 0
    /* If unsuccessful, return non-zero.
<a name="anchor-68"></a>     * You may store an error message in errbuf.
     * The return value and error message will be displayed to the user.
     * Pro/ENGINEER will call user_terminate() and shut down your application
     */
     ProStringToWstring(errbuf, &quot;Sample error message&quot;);
<a name="anchor-69"></a>     return(-1);
#endif
}

/*====================================================================*\
<a name="anchor-70"></a>FUNCTION : user_terminate()
PURPOSE  : To handle any termination actions
\*====================================================================*/
extern &quot;C&quot; void user_terminate()
{
<a name="anchor-71"></a>/*---------------------------------------------------------------------*\
   Loging file close. 
\*---------------------------------------------------------------------*/
    ProTestErrlogClose();

<a name="anchor-72"></a>    cout &lt;&lt; &quot;user_terminate&quot; &lt;&lt; endl;
}

/*====================================================================*\
FUNCTION : ProTestInstallationCheck
<a name="anchor-73"></a>PURPOSE  : Open a internationalized modal dialog with the test result
\*====================================================================*/
ProError  ProTestInstallationCheck()
{
    int window_id;
<a name="anchor-74"></a>    ProError status; 
    ProBoolean 	is_successful = PRO_B_FALSE; 

    /* Call a sample Pro/TOOLKIT feature */
    status = ProWindowCurrentGet ( &amp;window_id ); 
<a name="anchor-75"></a>    TEST_CALL_REPORT( &quot;ProWindowCurrentGet&quot;, &quot;ProTestInstallationCheck&quot;,
                      status, status != PRO_TK_NO_ERROR);

    if ( status == PRO_TK_NO_ERROR )
    {
<a name="anchor-76"></a>         /* Set flag for a SUCCESS dialog */ 
      is_successful = PRO_B_TRUE; 
    }
    else
    {
<a name="anchor-77"></a>         /* Set flag for a FAILURE dialog */ 
      is_successful = PRO_B_FALSE; 
    }

/*---------------------------------------------------------------------*\
<a name="anchor-78"></a>         Create and Display the dialog
\*---------------------------------------------------------------------*/
      status = ProTestDialogCreate ( is_successful ); 
      TEST_CALL_REPORT( &quot;ProTestDialogCreate&quot;, &quot;ProTestInstallationCheck&quot;,
                      status, status != PRO_TK_NO_ERROR);
<a name="anchor-79"></a>
  return (status);
}

/*====================================================================*\
<a name="anchor-80"></a>FUNCTION : ProTestStdCloseAction
PURPOSE  : Close Action for Dialog
\*====================================================================*/
static ProError ProTestStdCloseAction (char* dialog, char* component, ProAppData data)
{
<a name="anchor-81"></a>  ProError status;

  status = ProUIDialogExit (dialog, PRO_TK_NO_ERROR);
  TEST_CALL_REPORT( &quot;ProUIDialogExit&quot;, &quot;ProTestStdCloseAction&quot;,
                      status, status != PRO_TK_NO_ERROR);
<a name="anchor-82"></a>  return status; 
}

/*====================================================================*\
FUNCTION : ProTestInstallationURLCheck
<a name="anchor-83"></a>PURPOSE  : Open the URL for PTC Supports Web Page in Embedded Browser
\*====================================================================*/
ProError  ProTestInstallationURLCheck()
{
    int 	window_id;
<a name="anchor-84"></a>    ProError 	status; 
    ProComment 	url; 

/*---------------------------------------------------------------------*\
         Call a sample Pro/TOOLKIT feature 
<a name="anchor-85"></a>\*---------------------------------------------------------------------*/
    status = ProWindowCurrentGet ( &amp;window_id ); 
    TEST_CALL_REPORT( &quot;ProWindowCurrentGet&quot;, &quot;ProTestInstallationURLCheck&quot;,
                      status, status != PRO_TK_NO_ERROR);

<a name="anchor-86"></a>    if ( status == PRO_TK_NO_ERROR ) 
    {
/*---------------------------------------------------------------------*\
         Load a sample URL 
\*---------------------------------------------------------------------*/
<a name="anchor-87"></a>      ProStringToWstring ( url, &quot;http://www.ptc.com/partners/hardware/current/support.htm&quot;); 
      status = ProWindowURLShow ( window_id, url ); 
      TEST_CALL_REPORT( &quot;ProWindowURLShow&quot;, &quot;ProTestInstallationURLCheck&quot;,
                      status, status != PRO_TK_NO_ERROR);
    }
<a name="anchor-88"></a>
    return (status); 
}

/*====================================================================*\
<a name="anchor-89"></a>FUNCTION : ProTestDialogCreate
PURPOSE  : Common utility for creation of dialog
\*====================================================================*/
ProError  ProTestDialogCreate ( ProBoolean  is_successful )
{
<a name="anchor-90"></a>    ProMdl 	model;
    int 	dialog_status; 
    ProError 	status; 
    ProComment  message_wchar; 

<a name="anchor-91"></a>
    char *	dialog = &quot;pt_install_dialog&quot;; 

    status = ProUIDialogCreate( dialog, dialog );
    TEST_CALL_REPORT( &quot;ProUIDialogCreate&quot;, &quot;ProTestDialogCreate&quot;,
<a name="anchor-92"></a>                      status, status != PRO_TK_NO_ERROR);

    status = ProUIDialogCloseActionSet( dialog, 
		(ProUIAction)ProTestStdCloseAction, NULL );
    TEST_CALL_REPORT( &quot;ProUIDialogCloseActionSet&quot;, &quot;ProTestDialogCreate&quot;,
<a name="anchor-93"></a>                      status, status != PRO_TK_NO_ERROR);

    status = ProUIPushbuttonActivateActionSet( dialog, &quot;CloseBtn&quot;,
		(ProUIAction)ProTestStdCloseAction, NULL );
    TEST_CALL_REPORT( &quot;ProUIPushbuttonActivateActionSet&quot;, &quot;ProTestDialogCreate&quot;,
<a name="anchor-94"></a>                      status, status != PRO_TK_NO_ERROR);

    if ( is_successful == PRO_B_TRUE )
    {
      status = ProMessageToBuffer ( message_wchar, MSGFIL, &quot;USER Succeeded&quot; ); 
<a name="anchor-95"></a>      TEST_CALL_REPORT( &quot;ProMessageToBuffer&quot;, &quot;ProTestDialogCreate&quot;,
                      status, status != PRO_TK_NO_ERROR);
    }
    else
    {
<a name="anchor-96"></a>      status = ProMessageToBuffer ( message_wchar, MSGFIL, &quot;USER Failed&quot; ); 
      TEST_CALL_REPORT( &quot;ProMessageToBuffer&quot;, &quot;ProTestDialogCreate&quot;,
                      status, status != PRO_TK_NO_ERROR);
    }

<a name="anchor-97"></a>    status = ProUILabelTextSet( dialog, &quot;Message&quot;, message_wchar ); 
    TEST_CALL_REPORT( &quot;ProUILabelTextSet&quot;, &quot;ProTestDialogCreate&quot;,
                      status, status != PRO_TK_NO_ERROR);

    status = ProUIDialogActivate( dialog, &amp;dialog_status );
<a name="anchor-98"></a>    TEST_CALL_REPORT( &quot;ProUIDialogActivate&quot;, &quot;ProTestDialogCreate&quot;,
                      status, status != PRO_TK_NO_ERROR);

    status = ProUIDialogDestroy( dialog );
    TEST_CALL_REPORT( &quot;ProUIDialogDestroy&quot;, &quot;ProTestDialogCreate&quot;,
<a name="anchor-99"></a>                      status, status != PRO_TK_NO_ERROR);

  return (status);
}
</pre>
</body>
</html>
