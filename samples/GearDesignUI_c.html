<html>
<head>
<title>GearDesignUI.c</title>
</head>
<body bgcolor="#ffffff">
<pre><a name="anchor-0"></a>
/*
	Copyright (c) 2024 PTC Inc. and/or Its Subsidiary Companies. All Rights Reserved.
*/

<a name="anchor-1"></a>#include &lt;GearDesign.h>

#include &lt;ProUI.h>
#include &lt;ProUIDialog.h>
#include &lt;ProParameter.h>
<a name="anchor-2"></a>#include &lt;ProUIRadiogroup.h>
#include &lt;ProUILabel.h>
#include &lt;ProUICascadebutton.h>
#include &lt;ProUICheckbutton.h>
#include &lt;ProUIDashboard.h>
<a name="anchor-3"></a>#include &lt;ProUIDrawingarea.h>
#include &lt;ProUIInputpanel.h>
#include &lt;ProUIPushbutton.h>
#include &lt;ProUISpinbox.h>
#include &lt;ProUITable.h>
<a name="anchor-4"></a>#include &lt;UtilString.h>
#include &lt;ProUITab.h>
#include &lt;ProMessage.h>
#include &lt;stdlib.h>

<a name="anchor-5"></a>
#define GD_UI_MAIN &quot;geardesigndlg&quot;

#define GD_UI_CLOSEBTN &quot;CloseBtn&quot;
#define GD_UI_CLOSEBTN_M &quot;CloseBtn_M&quot;
<a name="anchor-6"></a>#define GD_UI_LOADBTN_M &quot;LoadBtn_M&quot;
#define GD_UI_GEARTYPE_GROUP_M &quot;GearTypeGroup_M&quot;

#define GD_UI_LOADBTN_RMB &quot;LoadBtn_RMB&quot;
#define GD_UI_GEARTYPE_GROUP_RMB &quot;GearTypeGroup_RMB&quot;
<a name="anchor-7"></a>

#define GD_UI_TOOL_DELETE_M &quot;DeleteBtn_M&quot;
#define GD_UI_TOOL_MODIFY_M &quot;ModifyBtn_M&quot;
#define GD_UI_TOOL_REGENERATE_M &quot;RegenerateBtn_M&quot;
<a name="anchor-8"></a>#define GD_UI_TOOL_MATERIAL_M &quot;MaterialBtn_M&quot;
#define GD_UI_TOOL_SAVEDVIEWS_CASCADE_M  &quot;SavedViewsCascade_M&quot;
#define GD_UI_TOOL_VIEW_CHOICE_M &quot;SavedViewsChoice_M&quot;
#define GD_UI_TOOL_VIEW_DEFAULTCREATE_M &quot;CreateDefaultView_M&quot;
#define GD_UI_TOOL_VIEW_STORE_M &quot;StoreView_M&quot;
<a name="anchor-9"></a>
#define GD_UI_GROUP_SPUR &quot;SPUR&quot;
#define GD_UI_GROUP_RING &quot;RING&quot;
#define GD_UI_GROUP_HELICAL &quot;HELICAL&quot;

<a name="anchor-10"></a>#define GD_UI_LOADBTN &quot;LoadBtn&quot;

#define GD_UI_CREATEBTN &quot;CreateButton&quot;

#define GD_UI_MAINTAB &quot;GearDesignSteps&quot;
<a name="anchor-11"></a>
#define GD_UI_DATUM_LAYOUT &quot;DefaultDatums&quot;
#define GD_UI_DISK_LAYOUT &quot;GearDisk&quot;
#define GD_UI_HOLE_LAYOUT &quot;GearHole&quot;
#define GD_UI_HUB_LAYOUT &quot;GearHub&quot;
<a name="anchor-12"></a>#define GD_UI_BACKPLATE_LAYOUT &quot;GearBackPlate&quot;
#define GD_UI_TEETH_LAYOUT &quot;GearTeeth&quot;

#define GD_UI_LABEL_COMPLETED &quot;CreatedLabel&quot;
#define GD_UI_LABEL_NOT_COMPLETED &quot;NotCreatedLabel&quot;
<a name="anchor-13"></a>
#define GD_UI_STATUS_TABLE &quot;ComponentsTable&quot;

#define GD_UI_STATUS_DONECOL &quot;Created&quot;
#define GD_UI_STATUS_COMPCOL &quot;Component&quot;
<a name="anchor-14"></a>#define GD_UI_STATUS_REQCOL &quot;Required&quot;

#define GD_UI_DATUM_ROW &quot;Datums&quot;
#define GD_UI_DISK_ROW &quot;Disk&quot;
#define GD_UI_HOLE_ROW &quot;Hole&quot;
<a name="anchor-15"></a>#define GD_UI_HUB_ROW &quot;Hub&quot;
#define GD_UI_BACKPLATE_ROW &quot;Back Plate&quot;
#define GD_UI_TEETH_ROW &quot;Teeth&quot;

#define GD_UI_XOFFSET_INPUT &quot;XOffsetInput&quot;
<a name="anchor-16"></a>#define GD_UI_YOFFSET_INPUT &quot;YOffsetInput&quot;
#define GD_UI_ZOFFSET_INPUT &quot;ZOffsetInput&quot;

#define GD_UI_GEARDISK_W_INPUT &quot;GearDiskWidth&quot;
#define GD_UI_GEARDISK_D_INPUT &quot;GearDiskDiameter&quot;
<a name="anchor-17"></a>
#define GD_UI_GEARHOLE_D_INPUT &quot;GearHoleDiameter&quot;
#define GD_UI_KEYWAY_W_INPUT &quot;KeywayWidth&quot;
#define GD_UI_KEYWAY_H_INPUT &quot;KeywayHeight&quot;
#define GD_UI_KEYWAY_W_LABEL &quot;KeywayWidthLabel&quot;
<a name="anchor-18"></a>#define GD_UI_KEYWAY_H_LABEL &quot;KeywayHeightLabel&quot;
#define GD_UI_INCLUDE_KEYWAY &quot;IncludeKeywayCheck&quot;

#define GD_UI_GEARHUB_D_INPUT &quot;HubDiameter&quot;
#define GD_UI_GEARHUB_T_INPUT &quot;HubThickness&quot;
<a name="anchor-19"></a>#define GD_UI_KEY_W_INPUT &quot;KeyWidth&quot;
#define GD_UI_KEY_H_INPUT &quot;KeyHeight&quot;
#define GD_UI_KEY_W_LABEL &quot;KeyWidthLabel&quot;
#define GD_UI_KEY_H_LABEL &quot;KeyHeightLabel&quot;
#define GD_UI_INCLUDE_KEY &quot;IncludeKeyCheck&quot;
<a name="anchor-20"></a>
#define GD_UI_BN_R_INPUT &quot;BackNotchRadius&quot;
#define GD_UI_BP_D_INPUT &quot;BackPlateDiameter&quot;
#define GD_UI_BP_T_INPUT &quot;BackPlateThickness&quot;
#define GD_UI_BN_R_LABEL &quot;BackNotchRadiusLabel&quot;
<a name="anchor-21"></a>#define GD_UI_INCLUDE_BN &quot;IncludeBacknotchCheck&quot;

#define GD_UI_N_TEETH_SPINBOX &quot;NumTeeth&quot;
#define GD_UI_TOOTH_INNER_SURF_LABEL &quot;ToothInnerSurfaceLabel&quot;
#define GD_UI_TOOTH_INNER_SURF_INPUT &quot;ToothInnerSurface&quot;
<a name="anchor-22"></a>#define GD_UI_TOOTH_PRESSURE_ANGLE &quot;GearToothPressureAngle&quot;
#define GD_UI_TOOTH_P1_INPUT &quot;GearToothParam1&quot;
#define GD_UI_HELIX_ANGLE &quot;HelixAngle&quot;
#define GD_UI_HELIX_ANGLE_LABEL &quot;HelixAngleLabel&quot;

<a name="anchor-23"></a>#define GD_UI_MENUPANE_RMB &quot;MenuPane_RMB&quot;

static int ProTKGDUIDatumFromUIUpdate (GearParam* g_ptr);
static int ProTKGDUIDatumUIUpdate (GearParam* g_ptr);
static int ProTKGDUIDiskFromUIUpdate (GearParam* g_ptr);
<a name="anchor-24"></a>static int ProTKGDUIDiskUIUpdate (GearParam* g_ptr);
static int ProTKGDUIHoleFromUIUpdate (GearParam* g_ptr);
static int ProTKGDUIHoleUIUpdate (GearParam* g_ptr);
static int ProTKGDUIHubFromUIUpdate (GearParam* g_ptr);
static int ProTKGDUIHubUIUpdate (GearParam* g_ptr);
<a name="anchor-25"></a>static int ProTKGDUIBackplateFromUIUpdate (GearParam* g_ptr);
static int ProTKGDUIBackplateUIUpdate (GearParam* g_ptr);
static int ProTKGDUITeethFromUIUpdate (GearParam* g_ptr);
static int ProTKGDUITeethUIUpdate (GearParam* g_ptr);
static ProBoolean ProTKGDUICreateButtonUpdate (GearParam* g_ptr);
<a name="anchor-26"></a>int ProTKGDUIStatusTableInit (GearParam* g_ptr);
int ProTKGDUIStatusTableRowUpdate (GearParam* g_ptr, ProTKGDStep step, char* new_row_name);

typedef int (*ProTKGDUIInteractionFunction) (GearParam* g_ptr);

<a name="anchor-27"></a>/*--------------------------------------------------------------------*\
    Links creation step to table and layouts in the UI.
\*--------------------------------------------------------------------*/
typedef struct 
{
<a name="anchor-28"></a>  ProTKGDStep  step;
  char*        step_layout;
  char*        step_row_name;
  ProTKGDUIInteractionFunction  update_from_ui_function;
  ProTKGDUIInteractionFunction  update_ui_function;
<a name="anchor-29"></a>} ProTKGDUIStepComponent;

static ProTKGDUIStepComponent gd_components [] = 
{
  {PTK_GD_DATUM, GD_UI_DATUM_LAYOUT, GD_UI_DATUM_ROW, 
<a name="anchor-30"></a>   ProTKGDUIDatumFromUIUpdate, ProTKGDUIDatumUIUpdate},
  {PTK_GD_DISK, GD_UI_DISK_LAYOUT, GD_UI_DISK_ROW, 
   ProTKGDUIDiskFromUIUpdate, ProTKGDUIDiskUIUpdate},
  {PTK_GD_HOLE, GD_UI_HOLE_LAYOUT, GD_UI_HOLE_ROW,
   ProTKGDUIHoleFromUIUpdate, ProTKGDUIHoleUIUpdate},
<a name="anchor-31"></a>  {PTK_GD_HUB, GD_UI_HUB_LAYOUT, GD_UI_HUB_ROW, 
   ProTKGDUIHubFromUIUpdate, ProTKGDUIHubUIUpdate},
  {PTK_GD_BACKPLATE, GD_UI_BACKPLATE_LAYOUT, GD_UI_BACKPLATE_ROW, 
   ProTKGDUIBackplateFromUIUpdate, ProTKGDUIBackplateUIUpdate},
  {PTK_GD_TEETH, GD_UI_TEETH_LAYOUT, GD_UI_TEETH_ROW, 
<a name="anchor-32"></a>   ProTKGDUITeethFromUIUpdate, ProTKGDUITeethUIUpdate},
};

static ProError status;

<a name="anchor-33"></a>/*=============================================================*\
  Function: 	ProTKGDUIDatumUIUpdate
  Purpose:	Datum parameters -> UI
\*=============================================================*/
int ProTKGDUIDatumUIUpdate (GearParam* g_ptr)
<a name="anchor-34"></a>{
  status = ProUIInputpanelDoubleSet (GD_UI_MAIN, GD_UI_XOFFSET_INPUT, g_ptr->datum_x_offset);
  status = ProUIInputpanelDoubleSet (GD_UI_MAIN, GD_UI_YOFFSET_INPUT, g_ptr->datum_y_offset);
  status = ProUIInputpanelDoubleSet (GD_UI_MAIN, GD_UI_ZOFFSET_INPUT, g_ptr->datum_z_offset);

<a name="anchor-35"></a>  ProTKGDUICreateButtonUpdate (g_ptr);

  return PRO_TK_NO_ERROR;
}

<a name="anchor-36"></a>/*=============================================================*\
  Function: 	ProTKGDUIDatumFromUIUpdate
  Purpose:	Datum parameters &lt;- UI
\*=============================================================*/
int ProTKGDUIDatumFromUIUpdate (GearParam* g_ptr)
<a name="anchor-37"></a>{
  status = ProUIInputpanelDoubleGet (GD_UI_MAIN, GD_UI_XOFFSET_INPUT, &amp;g_ptr->datum_x_offset);
  status = ProUIInputpanelDoubleGet (GD_UI_MAIN, GD_UI_YOFFSET_INPUT, &amp;g_ptr->datum_y_offset);
  status = ProUIInputpanelDoubleGet (GD_UI_MAIN, GD_UI_ZOFFSET_INPUT, &amp;g_ptr->datum_z_offset);

<a name="anchor-38"></a>  return PRO_TK_NO_ERROR;
}

/*=============================================================*\
  Function: 	ProTKGDUIDiskUIUpdate
<a name="anchor-39"></a>  Purpose:	Disk parameters -> UI
\*=============================================================*/
int ProTKGDUIDiskUIUpdate (GearParam* g_ptr)
{
  status = ProUIInputpanelDoubleSet (GD_UI_MAIN, GD_UI_GEARDISK_D_INPUT, g_ptr->gear_diam);
<a name="anchor-40"></a>  status = ProUIInputpanelDoubleSet (GD_UI_MAIN, GD_UI_GEARDISK_W_INPUT, g_ptr->gear_depth);
  
  
  if (g_ptr->gear_type == HELICAL_GEAR)
    {
<a name="anchor-41"></a>      ProUILabelShow (GD_UI_MAIN, GD_UI_HELIX_ANGLE_LABEL);
      ProUIInputpanelShow (GD_UI_MAIN, GD_UI_HELIX_ANGLE);
      status = ProUIInputpanelDoubleSet (GD_UI_MAIN, GD_UI_HELIX_ANGLE, g_ptr->helix_angle);
    }
  else
<a name="anchor-42"></a>    {
      ProUILabelHide (GD_UI_MAIN, GD_UI_HELIX_ANGLE_LABEL);
      ProUIInputpanelHide (GD_UI_MAIN, GD_UI_HELIX_ANGLE);

    }
<a name="anchor-43"></a>  
  if (ProTKGDUICreateButtonUpdate (g_ptr))
    {
      if (g_ptr->gear_depth == 0.0 || g_ptr->gear_diam == 0.0)
	ProUIPushbuttonDisable (GD_UI_MAIN, GD_UI_CREATEBTN);
<a name="anchor-44"></a>      else
	ProUIPushbuttonEnable (GD_UI_MAIN, GD_UI_CREATEBTN);
    }

   return PRO_TK_NO_ERROR;
<a name="anchor-45"></a>}

/*=============================================================*\
  Function: 	ProTKGDUIDiskFromUIUpdate
  Purpose:	Disk parameters &lt;- UI
<a name="anchor-46"></a>\*=============================================================*/
int ProTKGDUIDiskFromUIUpdate (GearParam* g_ptr)
{
  status = ProUIInputpanelDoubleGet (GD_UI_MAIN, GD_UI_GEARDISK_D_INPUT, &amp;g_ptr->gear_diam);
  status = ProUIInputpanelDoubleGet (GD_UI_MAIN, GD_UI_GEARDISK_W_INPUT, &amp;g_ptr->gear_depth);
<a name="anchor-47"></a>  if (g_ptr->gear_type == HELICAL_GEAR)
  {
    ProUIInputpanelDoubleGet (GD_UI_MAIN, GD_UI_HELIX_ANGLE, &amp;g_ptr->helix_angle);
  }
  return PRO_TK_NO_ERROR;
<a name="anchor-48"></a>}

/*=============================================================*\
  Function: 	ProTKGDUIKeywayUIUpdate
  Purpose:	Keyway parameters -> UI
<a name="anchor-49"></a>\*=============================================================*/
int ProTKGDUIKeywayUIUpdate (GearParam* g_ptr, ProBoolean create)
{
  if (create)
    {
<a name="anchor-50"></a>      ProUILabelEnable (GD_UI_MAIN, GD_UI_KEYWAY_W_LABEL);
      ProUILabelEnable (GD_UI_MAIN, GD_UI_KEYWAY_H_LABEL);
      ProUIInputpanelEnable (GD_UI_MAIN, GD_UI_KEYWAY_W_INPUT);
      ProUIInputpanelEnable (GD_UI_MAIN, GD_UI_KEYWAY_H_INPUT);
    }
<a name="anchor-51"></a>  else
    {
      ProUILabelDisable (GD_UI_MAIN, GD_UI_KEYWAY_W_LABEL);
      ProUILabelDisable (GD_UI_MAIN, GD_UI_KEYWAY_H_LABEL);
      ProUIInputpanelDisable (GD_UI_MAIN, GD_UI_KEYWAY_W_INPUT);
<a name="anchor-52"></a>      ProUIInputpanelDisable (GD_UI_MAIN, GD_UI_KEYWAY_H_INPUT);
    }

  ProUIInputpanelDoubleSet (GD_UI_MAIN, GD_UI_KEYWAY_W_INPUT, g_ptr->keyway_in_width);
  ProUIInputpanelDoubleSet (GD_UI_MAIN, GD_UI_KEYWAY_H_INPUT, g_ptr->keyway_in_height);
<a name="anchor-53"></a>
   return PRO_TK_NO_ERROR;
}

/*=============================================================*\
<a name="anchor-54"></a>  Function: 	ProTKGDUIKeywayFromUIUpdate
  Purpose:	Keyway parameters &lt;- UI
\*=============================================================*/
int ProTKGDUIKeywayFromUIUpdate (GearParam* g_ptr)
{
<a name="anchor-55"></a>  status = ProUIInputpanelDoubleGet (GD_UI_MAIN, GD_UI_KEYWAY_W_INPUT, &amp;g_ptr->keyway_in_width);
  status = ProUIInputpanelDoubleGet (GD_UI_MAIN, GD_UI_KEYWAY_H_INPUT, &amp;g_ptr->keyway_in_height);
  
  return PRO_TK_NO_ERROR;
}
<a name="anchor-56"></a>
/*=============================================================*\
  Function: 	ProTKGDUIHoleUIUpdate
  Purpose:	Hole parameters -> UI
\*=============================================================*/
<a name="anchor-57"></a>int ProTKGDUIHoleUIUpdate (GearParam* g_ptr)
{
  ProBoolean show_keyway;

  status = ProUIInputpanelDoubleSet (GD_UI_MAIN, GD_UI_GEARHOLE_D_INPUT, g_ptr->inner_diam);
<a name="anchor-58"></a>  
  if (ProTKGDUICreateButtonUpdate (g_ptr))
    {
      if (g_ptr->inner_diam == 0.0)
	ProUIPushbuttonDisable (GD_UI_MAIN, GD_UI_CREATEBTN);
<a name="anchor-59"></a>      else
	ProUIPushbuttonEnable (GD_UI_MAIN, GD_UI_CREATEBTN);
    }
 
  show_keyway = (g_ptr->keyway_created)?PRO_B_TRUE:PRO_B_FALSE;
<a name="anchor-60"></a>
  ProTKGDUIKeywayUIUpdate (g_ptr, show_keyway);

  if (g_ptr->keyway_created)
    ProUICheckbuttonSet (GD_UI_MAIN, GD_UI_INCLUDE_KEYWAY);
<a name="anchor-61"></a>

   return PRO_TK_NO_ERROR;
}

<a name="anchor-62"></a>/*=============================================================*\
  Function: 	ProTKGDUIHoleFromUIUpdate
  Purpose:	Hole parameters &lt;- UI
\*=============================================================*/
int ProTKGDUIHoleFromUIUpdate (GearParam* g_ptr)
<a name="anchor-63"></a>{
  status = ProUIInputpanelDoubleGet (GD_UI_MAIN, GD_UI_GEARHOLE_D_INPUT, &amp;g_ptr->inner_diam);
 
  return PRO_TK_NO_ERROR;
}
<a name="anchor-64"></a>
/*=============================================================*\
  Function: 	ProTKGDUIKeyUIUpdate
  Purpose:	Key parameters -> UI
\*=============================================================*/
<a name="anchor-65"></a>int ProTKGDUIKeyUIUpdate (GearParam* g_ptr, ProBoolean create)
{
  if (create)
    {
      ProUILabelEnable (GD_UI_MAIN, GD_UI_KEY_W_LABEL);
<a name="anchor-66"></a>      ProUILabelEnable (GD_UI_MAIN, GD_UI_KEY_H_LABEL);
      ProUIInputpanelEnable (GD_UI_MAIN, GD_UI_KEY_W_INPUT);
      ProUIInputpanelEnable (GD_UI_MAIN, GD_UI_KEY_H_INPUT);
    }
  else
<a name="anchor-67"></a>    {
      ProUILabelDisable (GD_UI_MAIN, GD_UI_KEY_W_LABEL);
      ProUILabelDisable (GD_UI_MAIN, GD_UI_KEY_H_LABEL);
      ProUIInputpanelDisable (GD_UI_MAIN, GD_UI_KEY_W_INPUT);
      ProUIInputpanelDisable (GD_UI_MAIN, GD_UI_KEY_H_INPUT);
<a name="anchor-68"></a>    }

  ProUIInputpanelDoubleSet (GD_UI_MAIN, GD_UI_KEY_W_INPUT, g_ptr->keyway_out_width);
  ProUIInputpanelDoubleSet (GD_UI_MAIN, GD_UI_KEY_H_INPUT, g_ptr->keyway_out_height);

<a name="anchor-69"></a>   return PRO_TK_NO_ERROR;
}

/*=============================================================*\
  Function: 	ProTKGDUIKeyFromUIUpdate
<a name="anchor-70"></a>  Purpose:	Key parameters &lt;- UI
\*=============================================================*/
int ProTKGDUIKeyFromUIUpdate (GearParam* g_ptr)
{
  status = ProUIInputpanelDoubleGet (GD_UI_MAIN, GD_UI_KEY_W_INPUT, &amp;g_ptr->keyway_out_width);
<a name="anchor-71"></a>  status = ProUIInputpanelDoubleGet (GD_UI_MAIN, GD_UI_KEY_H_INPUT, &amp;g_ptr->keyway_out_height);
  
  return PRO_TK_NO_ERROR;
}

<a name="anchor-72"></a>/*=============================================================*\
  Function: 	ProTKGDUIHubUIUpdate
  Purpose:	Hub parameters -> UI
\*=============================================================*/
int ProTKGDUIHubUIUpdate (GearParam* g_ptr)
<a name="anchor-73"></a>{
  ProBoolean show_key;

  status = ProUIInputpanelDoubleSet (GD_UI_MAIN, GD_UI_GEARHUB_D_INPUT, g_ptr->hub_out_diam);
  status = ProUIInputpanelDoubleSet (GD_UI_MAIN, GD_UI_GEARHUB_T_INPUT, g_ptr->hub_depth);
<a name="anchor-74"></a>
  if (ProTKGDUICreateButtonUpdate (g_ptr))
    {
      if (g_ptr->hub_out_diam == 0.0 || g_ptr->hub_depth == 0.0)
	ProUIPushbuttonDisable (GD_UI_MAIN, GD_UI_CREATEBTN);
<a name="anchor-75"></a>      else
	ProUIPushbuttonEnable (GD_UI_MAIN, GD_UI_CREATEBTN);
    }
  show_key = (g_ptr->key_created)?PRO_B_TRUE:PRO_B_FALSE;

<a name="anchor-76"></a>  ProTKGDUIKeyUIUpdate (g_ptr, show_key);

  if (g_ptr->key_created)
    ProUICheckbuttonSet (GD_UI_MAIN, GD_UI_INCLUDE_KEY);

<a name="anchor-77"></a>   return PRO_TK_NO_ERROR;
}

/*=============================================================*\
  Function: 	ProTKGDUIHubFromUIUpdate
<a name="anchor-78"></a>  Purpose:	Hub parameters &lt;- UI
\*=============================================================*/
int ProTKGDUIHubFromUIUpdate (GearParam* g_ptr)
{
  status = ProUIInputpanelDoubleGet (GD_UI_MAIN, GD_UI_GEARHUB_D_INPUT, &amp;g_ptr->hub_out_diam);
<a name="anchor-79"></a>  status = ProUIInputpanelDoubleGet (GD_UI_MAIN, GD_UI_GEARHUB_T_INPUT, &amp;g_ptr->hub_depth);
 
  return PRO_TK_NO_ERROR;
}

<a name="anchor-80"></a>/*=============================================================*\
  Function: 	ProTKGDUIBacknotchUIUpdate
  Purpose:	Backnotch parameters -> UI
\*=============================================================*/
int ProTKGDUIBacknotchUIUpdate (GearParam* g_ptr, ProBoolean create)
<a name="anchor-81"></a>{
  if (create)
    {
      ProUILabelEnable (GD_UI_MAIN, GD_UI_BN_R_LABEL);
      ProUIInputpanelEnable (GD_UI_MAIN, GD_UI_BN_R_INPUT);
<a name="anchor-82"></a>    }
  else
    {
      ProUILabelDisable (GD_UI_MAIN, GD_UI_BN_R_LABEL);
      ProUIInputpanelDisable (GD_UI_MAIN, GD_UI_BN_R_INPUT);
<a name="anchor-83"></a>    }

  ProUIInputpanelDoubleSet (GD_UI_MAIN, GD_UI_BN_R_INPUT, g_ptr->backnotch_rad);

   return PRO_TK_NO_ERROR;
<a name="anchor-84"></a>}

/*=============================================================*\
  Function: 	ProTKGDUIBacknotchFromUIUpdate
  Purpose:	Backnotch parameters &lt;- UI
<a name="anchor-85"></a>\*=============================================================*/
int ProTKGDUIBacknotchFromUIUpdate (GearParam* g_ptr)
{
  status = ProUIInputpanelDoubleGet (GD_UI_MAIN, GD_UI_BN_R_INPUT, &amp;g_ptr->backnotch_rad);
  
<a name="anchor-86"></a>  return PRO_TK_NO_ERROR;
}

/*=============================================================*\
  Function: 	ProTKGDUIBackplateUIUpdate
<a name="anchor-87"></a>  Purpose:	Backplate parameters -> UI
\*=============================================================*/
int ProTKGDUIBackplateUIUpdate (GearParam* g_ptr)
{
  ProBoolean show_bn;
<a name="anchor-88"></a>
  status = ProUIInputpanelDoubleSet (GD_UI_MAIN, GD_UI_BP_D_INPUT, g_ptr->backplate_diam);
  status = ProUIInputpanelDoubleSet (GD_UI_MAIN, GD_UI_BP_T_INPUT, g_ptr->backplate_depth);

  if (ProTKGDUICreateButtonUpdate (g_ptr))
<a name="anchor-89"></a>    {
      if (/*g_ptr->backplate_created || */g_ptr->backplate_diam == 0.0 || g_ptr->backplate_depth == 0.0)
	ProUIPushbuttonDisable (GD_UI_MAIN, GD_UI_CREATEBTN);
      else
	ProUIPushbuttonEnable (GD_UI_MAIN, GD_UI_CREATEBTN);
<a name="anchor-90"></a>    }

  show_bn = (g_ptr->backnotch_created)?PRO_B_TRUE:PRO_B_FALSE;

  ProTKGDUIBacknotchUIUpdate (g_ptr, show_bn);
<a name="anchor-91"></a>
  if (g_ptr->backnotch_created)
    ProUICheckbuttonSet (GD_UI_MAIN, GD_UI_INCLUDE_BN);

   return PRO_TK_NO_ERROR;
<a name="anchor-92"></a>}

/*=============================================================*\
  Function: 	ProTKGDUIBackplateFromUIUpdate
  Purpose:	Backplate parameters &lt;- UI
<a name="anchor-93"></a>\*=============================================================*/
int ProTKGDUIBackplateFromUIUpdate (GearParam* g_ptr)
{
  status = ProUIInputpanelDoubleGet (GD_UI_MAIN, GD_UI_BP_D_INPUT, &amp;g_ptr->backplate_diam);
  status = ProUIInputpanelDoubleGet (GD_UI_MAIN, GD_UI_BP_T_INPUT, &amp;g_ptr->backplate_depth);
<a name="anchor-94"></a> 
  return PRO_TK_NO_ERROR;
}

/*=============================================================*\
<a name="anchor-95"></a>  Function: 	ProTKGDUITeethUIUpdate
  Purpose:	Teeth parameters -> UI
\*=============================================================*/
int ProTKGDUITeethUIUpdate (GearParam* g_ptr)
{
<a name="anchor-96"></a>  status = ProUIInputpanelDoubleSet (GD_UI_MAIN, GD_UI_TOOTH_PRESSURE_ANGLE, g_ptr->Pressure_angle);
  status = ProUIInputpanelDoubleSet (GD_UI_MAIN, GD_UI_TOOTH_P1_INPUT, g_ptr->tooth_par1);
  status = ProUISpinboxIntegerSet (GD_UI_MAIN, GD_UI_N_TEETH_SPINBOX, g_ptr->n_of_teeth);

  if (g_ptr->gear_type == RING_GEAR)
<a name="anchor-97"></a>    {
      ProUILabelShow (GD_UI_MAIN, GD_UI_TOOTH_INNER_SURF_LABEL);
      ProUIInputpanelShow (GD_UI_MAIN, GD_UI_TOOTH_INNER_SURF_INPUT);
      ProUIInputpanelDoubleSet (GD_UI_MAIN, GD_UI_TOOTH_INNER_SURF_INPUT,
				g_ptr->inner_diam);
<a name="anchor-98"></a>    }
  else
    {
      ProUILabelHide (GD_UI_MAIN, GD_UI_TOOTH_INNER_SURF_LABEL);
      ProUIInputpanelHide (GD_UI_MAIN, GD_UI_TOOTH_INNER_SURF_INPUT);
<a name="anchor-99"></a>
    }
  if (ProTKGDUICreateButtonUpdate (g_ptr))
    {
      if ( g_ptr->Pressure_angle == 0.0 ||
<a name="anchor-100"></a>	   g_ptr->tooth_par1  == 0.0 || g_ptr->n_of_teeth == 0)
	ProUIPushbuttonDisable (GD_UI_MAIN, GD_UI_CREATEBTN);
      else
	ProUIPushbuttonEnable (GD_UI_MAIN, GD_UI_CREATEBTN);
    }
<a name="anchor-101"></a>   return PRO_TK_NO_ERROR;
}

/*=============================================================*\
  Function: 	ProTKGDUITeethFromUIUpdate
<a name="anchor-102"></a>  Purpose:	Teeth parameters &lt;- UI
\*=============================================================*/
int ProTKGDUITeethFromUIUpdate (GearParam* g_ptr)
{
  status = ProUIInputpanelDoubleGet (GD_UI_MAIN, GD_UI_TOOTH_PRESSURE_ANGLE, &amp;g_ptr->Pressure_angle);
<a name="anchor-103"></a>  status = ProUIInputpanelDoubleGet (GD_UI_MAIN, GD_UI_TOOTH_P1_INPUT, &amp;g_ptr->tooth_par1);
  status = ProUISpinboxIntegerGet (GD_UI_MAIN, GD_UI_N_TEETH_SPINBOX, &amp;g_ptr->n_of_teeth);

  if (g_ptr->gear_type == RING_GEAR)
    ProUIInputpanelDoubleGet (GD_UI_MAIN, GD_UI_TOOTH_INNER_SURF_INPUT,
<a name="anchor-104"></a>			      &amp;g_ptr->inner_diam);

  return PRO_TK_NO_ERROR;
}

<a name="anchor-105"></a>
/*=============================================================*\
  Function: 	ProTKGDUIStepFromTableGet
  Purpose:	Utility: Get step id from table row
\*=============================================================*/
<a name="anchor-106"></a>int ProTKGDUIStepFromTableGet (char* table_row, ProTKGDStep* step)
{
  int ii;
  for (ii = 0;  ii &lt; NUM_GD_STEPS; ii ++)
    {
<a name="anchor-107"></a>      if (strcmp (table_row, gd_components[ii].step_row_name) == 0)
	{
	  *step = gd_components [ii].step;
	  return (int)PRO_TK_NO_ERROR;
	}
<a name="anchor-108"></a>    }
  return (int)PRO_TK_GENERAL_ERROR;
}

/*=============================================================*\
<a name="anchor-109"></a>  Function: 	ProTKGDUICreateButtonUpdate
  Purpose:	Utility: Update sensitivity of &quot;Create&quot; menu button
\*=============================================================*/
ProBoolean ProTKGDUICreateButtonUpdate (GearParam* g_ptr)
{
<a name="anchor-110"></a>  ProTKGDStep step = g_ptr->current_step;
  ProBoolean enable;

  switch (step)
    {
<a name="anchor-111"></a>    case  PTK_GD_DATUM:
      enable = (g_ptr->datum_created ?  PRO_B_FALSE : PRO_B_TRUE);
      break;
    case PTK_GD_DISK:
      enable = (g_ptr->disk_created ?  PRO_B_FALSE : PRO_B_TRUE);
<a name="anchor-112"></a>      break;
    case PTK_GD_HOLE:
      enable = (g_ptr->hole_created ?  PRO_B_FALSE : PRO_B_TRUE);
      break;
    case PTK_GD_HUB:
<a name="anchor-113"></a>      enable = (g_ptr->hub_created ?  PRO_B_FALSE : PRO_B_TRUE);
      break;
    case PTK_GD_BACKPLATE:
      enable = (g_ptr->backplate_created ?  PRO_B_FALSE : PRO_B_TRUE);
      break;
<a name="anchor-114"></a>    case PTK_GD_TEETH:
      enable = (g_ptr->teeth_created ?  PRO_B_FALSE : PRO_B_TRUE);
      break;
    }

<a name="anchor-115"></a>  if (enable)
    {
      if (step != PTK_GD_DATUM &amp;&amp; !g_ptr->datum_created)
	enable = PRO_B_FALSE;

<a name="anchor-116"></a>      if (step != PTK_GD_DATUM &amp;&amp; step != PTK_GD_DISK &amp;&amp; !g_ptr->disk_created)
	enable = PRO_B_FALSE;

      if (g_ptr->gear_type == RING_GEAR)
	if (step != PTK_GD_DATUM &amp;&amp; step != PTK_GD_DISK &amp;&amp; step != PTK_GD_BACKPLATE &amp;&amp; !g_ptr->backplate_created)
<a name="anchor-117"></a>	  enable = PRO_B_FALSE;
    }

  if (enable)
    ProUIPushbuttonEnable (GD_UI_MAIN, GD_UI_CREATEBTN);
<a name="anchor-118"></a>  else
    ProUIPushbuttonDisable (GD_UI_MAIN, GD_UI_CREATEBTN);

  return enable;
}
<a name="anchor-119"></a>

/*=============================================================*\
  Function: 	ProTKGDUIToggleType
  Purpose:	Utility: toggle type (ring &lt;-> spur) in the UI
<a name="anchor-120"></a>\*=============================================================*/
void ProTKGDUIToggleType (GearParam* g_ptr)
{
  /* Clear status table */
  ProUITableCellComponentDelete (GD_UI_MAIN, GD_UI_STATUS_TABLE,
<a name="anchor-121"></a>				 GD_UI_DATUM_ROW, GD_UI_STATUS_DONECOL);
  ProUITableCellComponentDelete (GD_UI_MAIN, GD_UI_STATUS_TABLE,
				 GD_UI_DISK_ROW, GD_UI_STATUS_DONECOL);
  if (g_ptr->gear_type == HELICAL_GEAR)
    {
<a name="anchor-122"></a>      ProUILabelShow (GD_UI_MAIN, GD_UI_HELIX_ANGLE_LABEL);
      ProUIInputpanelShow (GD_UI_MAIN, GD_UI_HELIX_ANGLE);
    }
  else
    {     
<a name="anchor-123"></a>      ProUILabelHide (GD_UI_MAIN, GD_UI_HELIX_ANGLE_LABEL);
      ProUIInputpanelHide (GD_UI_MAIN, GD_UI_HELIX_ANGLE);
    }
  ProUITableCellComponentDelete (GD_UI_MAIN, GD_UI_STATUS_TABLE,
				 GD_UI_HOLE_ROW, GD_UI_STATUS_DONECOL);
<a name="anchor-124"></a>  ProUITableCellComponentDelete (GD_UI_MAIN, GD_UI_STATUS_TABLE,
				 GD_UI_HUB_ROW, GD_UI_STATUS_DONECOL);
  ProUITableCellComponentDelete (GD_UI_MAIN, GD_UI_STATUS_TABLE,
				 GD_UI_BACKPLATE_ROW, GD_UI_STATUS_DONECOL);
  ProUITableCellComponentDelete (GD_UI_MAIN, GD_UI_STATUS_TABLE,
<a name="anchor-125"></a>				 GD_UI_TEETH_ROW, GD_UI_STATUS_DONECOL);

  ProUITableRownamesSet (GD_UI_MAIN, GD_UI_STATUS_TABLE, 0, NULL);

  if (g_ptr->gear_type == RING_GEAR)
<a name="anchor-126"></a>    {
      ProUILabelShow (GD_UI_MAIN, GD_UI_TOOTH_INNER_SURF_LABEL);
      ProUIInputpanelShow (GD_UI_MAIN, GD_UI_TOOTH_INNER_SURF_INPUT);
    }
  else
<a name="anchor-127"></a>    {     
      ProUILabelHide (GD_UI_MAIN, GD_UI_TOOTH_INNER_SURF_LABEL);
      ProUIInputpanelHide (GD_UI_MAIN, GD_UI_TOOTH_INNER_SURF_INPUT);
    }
  /* Reinitialize it */
<a name="anchor-128"></a>  ProTKGDUIStatusTableInit (g_ptr);
}


/*=============================================================*\
<a name="anchor-129"></a>  Function: 	ProTKGDUISelectNext
  Purpose:	Utility: select next item (typically after creation)
\*=============================================================*/
int   ProTKGDUISelectNext (GearParam* g_ptr, ProTKGDStep step)
{
<a name="anchor-130"></a>  ProTKGDStepInfo* order;
  int ii, current_index;
  ProTKGDStep next_step;
  char * next_select [2];

<a name="anchor-131"></a>  switch (g_ptr->gear_type)
    {
    case SPUR_GEAR:
      order = (ProTKGDStepInfo*)spur_gear_designinfo;
      break;
<a name="anchor-132"></a>    case HELICAL_GEAR:
      order = (ProTKGDStepInfo*)helical_gear_designinfo;
      break;
    case RING_GEAR:
      order = (ProTKGDStepInfo*)ring_gear_designinfo;
<a name="anchor-133"></a>      break;
    }

  for (ii = 0; ii &lt; NUM_GD_STEPS; ii++)
    {
<a name="anchor-134"></a>      if (order[ii].step == step)
	{
	  current_index = ii;
	  break;
	}
<a name="anchor-135"></a>    }
  
  ProTKGDUIStatusTableRowUpdate (g_ptr, step, gd_components[step].step_row_name);

  if (current_index != NUM_GD_STEPS - 1)
<a name="anchor-136"></a>    {
      next_step = order [current_index + 1].step;
      next_select[0] = gd_components[next_step].step_row_name;
      next_select[1] = GD_UI_STATUS_COMPCOL;
      
<a name="anchor-137"></a>      g_ptr->current_step = next_step;
      
      ProUITableSelectednamesSet (GD_UI_MAIN, GD_UI_STATUS_TABLE,
				  2, next_select);
   
<a name="anchor-138"></a>      ProUITabSelectednamesSet (GD_UI_MAIN, GD_UI_MAINTAB,
				1, &amp;gd_components[next_step].step_layout);

      gd_components [next_step].update_ui_function (g_ptr); 
    }
<a name="anchor-139"></a>
  return PRO_TK_NO_ERROR;
}

/*=============================================================*\
<a name="anchor-140"></a>  Function: 	ProTKGDUIStatusTableRowUpdate
  Purpose:	Utility: update the creation status icon in table
\*=============================================================*/
int ProTKGDUIStatusTableRowUpdate (GearParam* g_ptr,
				   ProTKGDStep step,
<a name="anchor-141"></a>				   char* new_row_name)
{
  ProBoolean created = PRO_B_FALSE;
  char* current_component;
  char* new_component;
<a name="anchor-142"></a>  char* source_label;

  switch (step)
    {
    case PTK_GD_DATUM:
<a name="anchor-143"></a>      if (g_ptr->datum_created)
	created = PRO_B_TRUE;
      new_component = &quot;DatumCreatedLabel&quot;;
      break;
    case PTK_GD_DISK:
<a name="anchor-144"></a>      if (g_ptr->disk_created)
	created = PRO_B_TRUE;
      new_component = &quot;DiskCreatedLabel&quot;;
      break;
    case PTK_GD_HOLE:
<a name="anchor-145"></a>      if (g_ptr->hole_created)
	created = PRO_B_TRUE;
      new_component = &quot;HoleCreatedLabel&quot;;
      break;
    case PTK_GD_HUB:
<a name="anchor-146"></a>      if (g_ptr->hub_created)
	created = PRO_B_TRUE;
      new_component = &quot;HubCreatedLabel&quot;;
      break;
    case PTK_GD_BACKPLATE:
<a name="anchor-147"></a>      if (g_ptr->backplate_created)
	created = PRO_B_TRUE;
      new_component = &quot;BackplateCreatedLabel&quot;;
      break;
    case PTK_GD_TEETH:
<a name="anchor-148"></a>      if (g_ptr->teeth_created)
	created = PRO_B_TRUE;
      new_component = &quot;TeethCreatedLabel&quot;;
      break;
    }
<a name="anchor-149"></a>
  ProUITableCellComponentDelete (GD_UI_MAIN,
				 GD_UI_STATUS_TABLE,
				 new_row_name,
				 GD_UI_STATUS_DONECOL);
<a name="anchor-150"></a>  if (created)
    source_label = GD_UI_LABEL_COMPLETED;
  else
    source_label = GD_UI_LABEL_NOT_COMPLETED;

<a name="anchor-151"></a>  ProUITableCellComponentCopy (GD_UI_MAIN,
			       GD_UI_STATUS_TABLE,
			       new_row_name,
			       GD_UI_STATUS_DONECOL,
			       GD_UI_MAIN,
<a name="anchor-152"></a>			       source_label,
			       new_component);

  return PRO_TK_NO_ERROR;
}
<a name="anchor-153"></a>

/*=============================================================*\
  Function: 	ProTKGDUIStatusTableRowAdd
  Purpose:	Utility: add the designated row to the table
<a name="anchor-154"></a>\*=============================================================*/
int ProTKGDUIStatusTableRowAdd (GearParam* g_ptr,
				ProTKGDStep step,
				ProBoolean required)
{
<a name="anchor-155"></a>  char ** row_names;
  int n_rows;
  char * new_row_name = gd_components [step].step_row_name;
  ProLine new_row_label;
  
<a name="anchor-156"></a>  status = ProUITableRownamesGet (GD_UI_MAIN, GD_UI_STATUS_TABLE, 
			 &amp;n_rows, &amp;row_names);
  if (status == PRO_TK_NO_ERROR &amp;&amp; n_rows > 0)
    {   
      ProUITableRowsInsert (GD_UI_MAIN, GD_UI_STATUS_TABLE,
<a name="anchor-157"></a>			    row_names [n_rows-1], 1, 
			    &amp;new_row_name);
      
      ProStringarrayFree (row_names, n_rows);
    }
<a name="anchor-158"></a>  else
    {
      ProUITableRowsInsert (GD_UI_MAIN, GD_UI_STATUS_TABLE,
			      NULL, 1, 
			      &amp;new_row_name);
<a name="anchor-159"></a>    }


  ProStringToWstring (new_row_label, new_row_name);
  ProUITableCellLabelSet (GD_UI_MAIN, GD_UI_STATUS_TABLE,
<a name="anchor-160"></a>			  new_row_name, GD_UI_STATUS_COMPCOL,
			  new_row_label);

  ProUITableCellLabelSet (GD_UI_MAIN, GD_UI_STATUS_TABLE,
			  new_row_name, GD_UI_STATUS_REQCOL,
<a name="anchor-161"></a>			  (required?L&quot;Required&quot;:L&quot;Optional&quot;));
			
			
  ProTKGDUIStatusTableRowUpdate (g_ptr, step, new_row_name);

<a name="anchor-162"></a>  return PRO_TK_NO_ERROR;
}

/*=============================================================*\
  Function: 	ProTKGDUIStatusTableInit
<a name="anchor-163"></a>  Purpose:	Utility: initialize the creation status table
\*=============================================================*/
int ProTKGDUIStatusTableInit (GearParam* g_ptr)
{
  ProTKGDStepInfo* order;
<a name="anchor-164"></a>  int ii;

  switch (g_ptr->gear_type)
    {
    case SPUR_GEAR:
<a name="anchor-165"></a>      order = (ProTKGDStepInfo*)spur_gear_designinfo;
      break;
    case HELICAL_GEAR:
      order = (ProTKGDStepInfo*)helical_gear_designinfo;
      break;
<a name="anchor-166"></a>    case RING_GEAR:
      order = (ProTKGDStepInfo*)ring_gear_designinfo;
      break;
    }

<a name="anchor-167"></a>  for (ii = 0; ii &lt; NUM_GD_STEPS; ii++)
    {
      ProTKGDUIStatusTableRowAdd (g_ptr, order [ii].step, order [ii].required);
    }

<a name="anchor-168"></a>  return PRO_TK_NO_ERROR;
}


/*=================== UI ACTION FUNCTIONS =====================*/
<a name="anchor-169"></a>
/*=============================================================*\
  Function: 	ProTKGDUICloseAction
  Purpose:	Close button action function
\*=============================================================*/
<a name="anchor-170"></a>void ProTKGDUICloseAction (char* dialog,
			   char *component,
			   ProAppData appdata)
{
  ProUIDialogExit (dialog, 0);
<a name="anchor-171"></a>}

/*=============================================================*\
  Function: 	ProTKGDUIDiskInputAction
  Purpose:	Disk params input action function
<a name="anchor-172"></a>\*=============================================================*/
void ProTKGDUIDiskInputAction (char* dialog,
				 char *component,
				 ProAppData appdata)
{
<a name="anchor-173"></a>  GearParam* g_ptr = (GearParam*)appdata;

  ProTKGDUIDiskFromUIUpdate (g_ptr);

  ProTKGDUIDiskUIUpdate (g_ptr);
<a name="anchor-174"></a>}

/*=============================================================*\
  Function: 	ProTKGDUIHoleInputAction
  Purpose:	Hole params input action function
<a name="anchor-175"></a>\*=============================================================*/
void ProTKGDUIHoleInputAction (char* dialog,
				 char *component,
				 ProAppData appdata)
{
<a name="anchor-176"></a>  GearParam* g_ptr = (GearParam*)appdata;

  ProTKGDUIHoleFromUIUpdate (g_ptr);

  ProTKGDUIHoleUIUpdate (g_ptr);
<a name="anchor-177"></a>}

/*=============================================================*\
  Function: 	ProTKGDUITableSelectAction
  Purpose:	Table selection action function
<a name="anchor-178"></a>\*=============================================================*/
void ProTKGDUITableSelectAction (char* dialog,
				 char *component,
				 ProAppData appdata)
{
<a name="anchor-179"></a>  GearParam* g_ptr = (GearParam*)appdata;
  ProTKGDStep step;
  int n_sel;
  char** selections;
  ProCharLine sel_row;
<a name="anchor-180"></a>
  ProUITableSelectednamesGet (GD_UI_MAIN, GD_UI_STATUS_TABLE,
			      &amp;n_sel, &amp;selections);
  
  /* Need to know only the selected row in the table */
<a name="anchor-181"></a>  strcpy (sel_row, selections [0]);
  
  ProStringarrayFree (selections, n_sel);

  ProTKGDUIStepFromTableGet (sel_row, &amp;step);
<a name="anchor-182"></a>
  status = ProUITabSelectednamesSet (GD_UI_MAIN, GD_UI_MAINTAB,
			    1, &amp;gd_components [step].step_layout);

  g_ptr->current_step = step;
<a name="anchor-183"></a>  gd_components [step].update_ui_function (g_ptr);
}



<a name="anchor-184"></a>/*=============================================================*\
  Function: 	ProTKGDUICreateAction
  Purpose:	&quot;Create&quot; button action function
\*=============================================================*/
void ProTKGDUICreateAction (char* dialog,
<a name="anchor-185"></a>				 char *component,
				 ProAppData appdata)
{
  ProError err;
  ProBoolean keyway, key, bn;
<a name="anchor-186"></a>  GearParam* g_ptr = (GearParam*)appdata;
  char ** selected_layout;
  int num_selected;
  ProTKGDStep step = g_ptr->current_step;

<a name="anchor-187"></a>  gd_components [step].update_from_ui_function (g_ptr);

  switch (step)
    {
    case PTK_GD_DATUM:
<a name="anchor-188"></a>      ProUserCreateDatum (g_ptr);
      break;
    case PTK_GD_DISK:
      ProUserCreateDisk (g_ptr);
      break;
<a name="anchor-189"></a>    case PTK_GD_HOLE:
      ProUserCreateHole (g_ptr);
      
      ProUICheckbuttonGetState (GD_UI_MAIN, GD_UI_INCLUDE_KEYWAY, &amp;keyway);
      
<a name="anchor-190"></a>      if (keyway)
	{
	  ProTKGDUIKeywayFromUIUpdate (g_ptr);
	  ProUserCreateKeyway (g_ptr);
	}
<a name="anchor-191"></a>      ProUIRadiogroupDisable (GD_UI_MAIN, GD_UI_GEARTYPE_GROUP_M);


      break;
    case PTK_GD_HUB:
<a name="anchor-192"></a>      ProUserCreateHub (g_ptr);

      ProUICheckbuttonGetState (GD_UI_MAIN, GD_UI_INCLUDE_KEY, &amp;key);
      
      if (key)
<a name="anchor-193"></a>	{
	  ProTKGDUIKeyFromUIUpdate (g_ptr);
	  ProUserCreateKey (g_ptr);
	}
      
<a name="anchor-194"></a>      ProUIRadiogroupDisable (GD_UI_MAIN, GD_UI_GEARTYPE_GROUP_M);

      
      break;
    case PTK_GD_BACKPLATE:
<a name="anchor-195"></a>      ProUserCreateBackPlate (g_ptr);

      ProUICheckbuttonGetState (GD_UI_MAIN, GD_UI_INCLUDE_BN, &amp;bn);
      
      if (bn)
<a name="anchor-196"></a>	{
	  ProTKGDUIBacknotchFromUIUpdate (g_ptr);
	  ProUserCreateBackNotch (g_ptr);
	}
      ProUIRadiogroupDisable (GD_UI_MAIN, GD_UI_GEARTYPE_GROUP_M);
<a name="anchor-197"></a>

      break;
    case PTK_GD_TEETH:
      if (g_ptr->gear_type == RING_GEAR)
<a name="anchor-198"></a>	ProUserCreateToothSurf (g_ptr);
      
      ProUserCreateTooth (g_ptr);

      ProUserCreateTeeth (g_ptr);
<a name="anchor-199"></a>      
      ProUIRadiogroupDisable (GD_UI_MAIN, GD_UI_GEARTYPE_GROUP_M);

      break;
    }
<a name="anchor-200"></a>
  gd_components [step].update_ui_function (g_ptr);

  ProTKGDUISelectNext (g_ptr, step);

<a name="anchor-201"></a>  return;
}

/*=============================================================*\
  Function: 	ProTKGDUIHubInputAction
<a name="anchor-202"></a>  Purpose:	Hub params input action function
\*=============================================================*/
void ProTKGDUIHubInputAction (char* dialog,
				 char *component,
				 ProAppData appdata)
<a name="anchor-203"></a>{
  GearParam* g_ptr = (GearParam*)appdata;

  ProTKGDUIHubFromUIUpdate (g_ptr);

<a name="anchor-204"></a>  ProTKGDUIHubUIUpdate (g_ptr);
}

/*=============================================================*\
  Function: 	ProTKGDUIBackplateInputAction
<a name="anchor-205"></a>  Purpose:	Backplate params input action function
\*=============================================================*/
void ProTKGDUIBackplateInputAction (char* dialog,
				 char *component,
				 ProAppData appdata)
<a name="anchor-206"></a>{
  GearParam* g_ptr = (GearParam*)appdata;

  ProTKGDUIBackplateFromUIUpdate (g_ptr);

<a name="anchor-207"></a>  ProTKGDUIBackplateUIUpdate (g_ptr);
}

/*=============================================================*\
  Function: 	ProTKGDUITeethInputAction
<a name="anchor-208"></a>  Purpose:	Teeth params input action function
\*=============================================================*/
void ProTKGDUITeethInputAction (char* dialog,
				 char *component,
				 ProAppData appdata)
<a name="anchor-209"></a>{
  GearParam* g_ptr = (GearParam*)appdata;

  ProTKGDUITeethFromUIUpdate (g_ptr);

<a name="anchor-210"></a>  ProTKGDUITeethUIUpdate (g_ptr);
}

/*=============================================================*\
  Function: 	ProTKGDUITeethUpdateAction
<a name="anchor-211"></a>  Purpose:	Teeth params update action function (spinbox)
\*=============================================================*/
void ProTKGDUITeethUpdateAction (char* dialog,
				 char *component,
				 ProAppData appdata)
<a name="anchor-212"></a>{
  GearParam* g_ptr = (GearParam*)appdata;
  
  ProTKGDUITeethFromUIUpdate (g_ptr);

<a name="anchor-213"></a>  ProTKGDUITeethUIUpdate (g_ptr);
} 

/*=============================================================*\
  Function: 	ProTKGDUIIncludeKeywayAction
<a name="anchor-214"></a>  Purpose:	Include keyway checkbox  action function
\*=============================================================*/
void ProTKGDUIIncludeKeywayAction (char* dialog,
				 char *component,
				 ProAppData appdata)
<a name="anchor-215"></a>{
  ProBoolean keyway;
  GearParam* g_ptr = (GearParam*)appdata;
   
  ProUICheckbuttonGetState (GD_UI_MAIN, GD_UI_INCLUDE_KEYWAY, &amp;keyway);
<a name="anchor-216"></a>
  ProTKGDUIKeywayUIUpdate (g_ptr, keyway);
}

/*=============================================================*\
<a name="anchor-217"></a>  Function: 	ProTKGDUIIncludeKeyAction
  Purpose:	Include key checkbox action function
\*=============================================================*/
void ProTKGDUIIncludeKeyAction (char* dialog,
				 char *component,
<a name="anchor-218"></a>				 ProAppData appdata)
{
  ProBoolean key;
  GearParam* g_ptr = (GearParam*)appdata;
   
<a name="anchor-219"></a>  ProUICheckbuttonGetState (GD_UI_MAIN, GD_UI_INCLUDE_KEY, &amp;key);

  ProTKGDUIKeyUIUpdate (g_ptr, key);
}

<a name="anchor-220"></a>/*=============================================================*\
  Function: 	ProTKGDUIIncludeBacknotchAction
  Purpose:	Include backnotch checkbox action function
\*=============================================================*/
void ProTKGDUIIncludeBacknotchAction (char* dialog,
<a name="anchor-221"></a>				 char *component,
				 ProAppData appdata)
{
  ProBoolean bn;
  GearParam* g_ptr = (GearParam*)appdata;
<a name="anchor-222"></a>   
  ProUICheckbuttonGetState (GD_UI_MAIN, GD_UI_INCLUDE_BN, &amp;bn);

  ProTKGDUIBacknotchUIUpdate (g_ptr, bn);
}
<a name="anchor-223"></a>
/*=============================================================*\
  Function: 	ProTKGDUIToggleTypeAction
  Purpose:	Action function for menu radiogroup (type)
\*=============================================================*/
<a name="anchor-224"></a>void ProTKGDUIToggleTypeAction (char* dialog,
				 char *component,
				 ProAppData appdata)
{
  GearParam* g_ptr = (GearParam*)appdata;
<a name="anchor-225"></a>  int n_sels;
  char** sel_names;
  int new_type;
  
  ProUIRadiogroupSelectednamesGet (GD_UI_MAIN, component,
<a name="anchor-226"></a>				   &amp;n_sels, &amp;sel_names);

  if (strcmp (sel_names[0], GD_UI_GROUP_SPUR) == 0)
    new_type = SPUR_GEAR;
  
<a name="anchor-227"></a>  /*if(strcmp (sel_names[0], GD_UI_GROUP_RING) == 0)
    new_type = RING_GEAR;*/
  
  if(strcmp (sel_names[0], GD_UI_GROUP_HELICAL) == 0)
    new_type = HELICAL_GEAR;
<a name="anchor-228"></a>    
  else
    new_type = RING_GEAR;

  ProStringarrayFree (sel_names, n_sels);
<a name="anchor-229"></a>
  if (new_type == g_ptr->gear_type)
    return;

  g_ptr->gear_type = new_type;
<a name="anchor-230"></a>
  ProTKGDUIToggleType (g_ptr);
}

/*=============================================================*\
<a name="anchor-231"></a>  Function: 	ProTKGDUILoadParamsAction
  Purpose:	Action function for &quot;Load Params&quot; button
\*=============================================================*/
void  ProTKGDUILoadParamsAction (char* dialog,
				 char *component,
<a name="anchor-232"></a>				 ProAppData appdata)
{
  GearParam* g_ptr = (GearParam*)appdata;
     int m_id, action, first=0;
    ProName   name;
<a name="anchor-233"></a>    static int mode=0;
    ProLine   w_ext;
    char line[PRO_PATH_SIZE];
    ProParameter param;
    ProParamvalue parvalue;
<a name="anchor-234"></a>    ProModelitem modelitem;
    ProPath  *w_path_arr, w_def_path, w_sel_path;
    ProName  *w_path_lab_arr;
    ProError err;
    char dlg_name [PRO_LINE_SIZE];
<a name="anchor-235"></a>    char* rg_entry;
	ProName unit_type; 
    int cur_type = g_ptr->gear_type;
	ProMdlName new_name;

<a name="anchor-236"></a>    strcpy (dlg_name, dialog);

/*-----------------------------------------------------------------*\
    Check Gear Design
\*-----------------------------------------------------------------*/
<a name="anchor-237"></a>   
    ProMdlToModelitem(g_ptr->model, &amp;modelitem);
    ProStringToWstring(name, &quot;Gear_Design&quot;);
    err = ProParameterInit(&amp;modelitem, name, &amp;param);
  
<a name="anchor-238"></a>    ProMessageDisplay(MSGFIL, &quot;PROTKGD Select a parameter file&quot;);
    
    ProStringToWstring(w_def_path, &quot;.&quot;);
    ProStringToWstring(w_ext, &quot;*.txt&quot;);
    
<a name="anchor-239"></a>    /* No default dirs */
    err = ProArrayAlloc(0, sizeof(ProPath), 1, (ProArray*)&amp;w_path_arr);
    err = ProArrayAlloc(0, sizeof(ProPath), 1, (ProArray*)&amp;w_path_lab_arr);
    
    /* Open file */
<a name="anchor-240"></a>    err = ProFileMdlnameOpen(NULL, w_ext, w_path_arr, w_path_lab_arr, w_def_path, NULL,
		      w_sel_path);
    
    ProArrayFree((ProArray*)&amp;w_path_arr);
    ProArrayFree((ProArray*)&amp;w_path_lab_arr);
<a name="anchor-241"></a>  

    ProWstringToString(line, w_sel_path);
    first = 1;
    
<a name="anchor-242"></a>    if (ProUserReadParamFile(line ,g_ptr)!=0)
      return;

      
    if (g_ptr->gear_type != cur_type)
<a name="anchor-243"></a>      ProTKGDUIToggleType (g_ptr);

    /*if (g_ptr->gear_type == RING_GEAR)
      rg_entry = GD_UI_GROUP_RING;*/
    if(g_ptr->gear_type == SPUR_GEAR)
<a name="anchor-244"></a>      rg_entry = GD_UI_GROUP_SPUR;
    if(g_ptr->gear_type == HELICAL_GEAR)
      rg_entry = GD_UI_GROUP_HELICAL;
    else
      rg_entry = GD_UI_GROUP_SPUR;
<a name="anchor-245"></a>    ProUIRadiogroupSelectednamesSet (GD_UI_MAIN,
				     GD_UI_GEARTYPE_GROUP_M,
				     1, &amp;rg_entry);

    ProTKGDUIDatumUIUpdate (g_ptr);
<a name="anchor-246"></a>    ProTKGDUIDiskUIUpdate (g_ptr);
    ProTKGDUIHoleUIUpdate (g_ptr);
    ProTKGDUIHubUIUpdate (g_ptr);
    ProTKGDUIBackplateUIUpdate (g_ptr);
    ProTKGDUITeethUIUpdate (g_ptr);
<a name="anchor-247"></a>
    ProParamvalueSet(&amp;parvalue, (void *)w_sel_path, PRO_PARAM_STRING);
    ProParameterWithUnitsCreate(&amp;modelitem, name, &amp;parvalue, NULL, &amp;param);
    ProStringToWstring(new_name, g_ptr->name);
    ProMdlnameRename(g_ptr->model, new_name);
<a name="anchor-248"></a>
    ProStringToWstring(name, g_ptr->material);
    ProPartMaterialSet((ProPart)g_ptr->model, name);

	{
<a name="anchor-249"></a>		ProUnititem* units;
		ProUnitsystem new_system;
		ProError status;

		switch(g_ptr->units)
<a name="anchor-250"></a>		{
		case PRO_UNITLENGTH_CM:
			ProStringToWstring(unit_type, &quot;cm&quot;);
			break;
		case PRO_UNITLENGTH_FT:
<a name="anchor-251"></a>			ProStringToWstring(unit_type, &quot;ft&quot;);
			break;
		case PRO_UNITLENGTH_IN:
			ProStringToWstring(unit_type, &quot;in&quot;);
			break;
<a name="anchor-252"></a>		case PRO_UNITLENGTH_M:
			ProStringToWstring(unit_type, &quot;m&quot;);
			break;
		case PRO_UNITLENGTH_MM:
			ProStringToWstring(unit_type, &quot;mm&quot;);
<a name="anchor-253"></a>			break;
		}

		status = ProArrayAlloc (1, sizeof (ProUnititem), 1, (ProArray*)&amp;units);
		status = ProUnitInit (g_ptr->model, unit_type, &amp;units[0]);
<a name="anchor-254"></a>		status = ProMdlUnitsystemCreate (g_ptr->model, PRO_UNITSYSTEM_MLT,
			L&quot;ParamLen M T&quot;, units, &amp;new_system);
		status = ProMdlPrincipalunitsystemSet(g_ptr->model, &amp;new_system,
			PRO_UNITCONVERT_SAME_SIZE, PRO_B_TRUE, PRO_VALUE_UNUSED);
	}
<a name="anchor-255"></a>
}

/*=============================================================*\
  Function: 	ProTKGDUIDeleteAction
<a name="anchor-256"></a>  Purpose:	Delete button action function
\*=============================================================*/
void  ProTKGDUIDeleteAction (char* dialog, char* component, 
			      ProAppData appdata)
{
<a name="anchor-257"></a>    GearParam* g_ptr = (GearParam*)appdata;

    ProUserDeleteDesign (g_ptr);
}

<a name="anchor-258"></a>/*=============================================================*\
  Function: 	ProTKGDUIModifyAction
  Purpose:	Modify button action function
\*=============================================================*/
void  ProTKGDUIModifyAction (char* dialog, char* component, 
<a name="anchor-259"></a>			      ProAppData appdata)
{
    GearParam* g_ptr = (GearParam*)appdata;

    ProUserModifyDesign (g_ptr);
<a name="anchor-260"></a>}

/*=============================================================*\
  Function: 	ProTKGDUIRegenerateAction
  Purpose:	Regenerate button action function
<a name="anchor-261"></a>\*=============================================================*/
void  ProTKGDUIRegenerateAction (char* dialog, char* component, 
			      ProAppData appdata)
{
    GearParam* g_ptr = (GearParam*)appdata;
<a name="anchor-262"></a>
    ProUserRegenerate (g_ptr);
}

/*=============================================================*\
<a name="anchor-263"></a>  Function: 	ProTKGDUIMaterialAction
  Purpose:	Set Material button action function
\*=============================================================*/
void  ProTKGDUIMaterialAction (char* dialog, char* component, 
			      ProAppData appdata)
<a name="anchor-264"></a>{
    GearParam* g_ptr = (GearParam*)appdata;

    ProUserMaterial (g_ptr);
}
<a name="anchor-265"></a>
/*=============================================================*\
  Function: 	ProTKGDUIViewSelectAction
  Purpose:	Saved view selection action function
\*=============================================================*/
<a name="anchor-266"></a>void  ProTKGDUIViewSelectAction (char* dialog, char* component, 
			      ProAppData appdata)
{
    GearParam* g_ptr = (GearParam*)appdata;
    char** names;
<a name="anchor-267"></a>    int n_names;
    ProName new_view;
    ProView view;
    
    ProUIRadiogroupSelectednamesGet (GD_UI_MAIN,
<a name="anchor-268"></a>				     GD_UI_TOOL_VIEW_CHOICE_M,
				     &amp;n_names, &amp;names);

    ProStringToWstring (new_view, names [0]);
    ProStringarrayFree (names, n_names);
<a name="anchor-269"></a>
    ProViewRetrieve(g_ptr->model, new_view, &amp;view);
}

/*=============================================================*\
<a name="anchor-270"></a>  Function: 	ProTKGDUIViewSelectAction
  Purpose:	Utility: update contents of the saved views radiogroup
\*=============================================================*/
void ProTKGDUIViewNamesUpdate (GearParam* g_ptr)
{
<a name="anchor-271"></a>  ProError err;
  ProLine* names;
  int num_views;
  int ii, len;
  char** new_names;
<a name="anchor-272"></a>  wchar_t** new_labels;

  err = ProViewNamesGet(g_ptr->model, &amp;names, NULL, &amp;num_views);
  if (err != PRO_TK_NO_ERROR || num_views&lt;=0)
    {
<a name="anchor-273"></a>      ProUICascadebuttonDisable (GD_UI_MAIN,
				 GD_UI_TOOL_SAVEDVIEWS_CASCADE_M);
    }	
  else
    {
<a name="anchor-274"></a>      ProUICascadebuttonEnable (GD_UI_MAIN,
				GD_UI_TOOL_SAVEDVIEWS_CASCADE_M);
    
      new_names = (char**) calloc (num_views, sizeof (char*));
      new_labels = (wchar_t**) calloc (num_views, sizeof (wchar_t*));
<a name="anchor-275"></a>      for (ii = 0; ii &lt; num_views; ii++)
	{
	  len = ProUtilWstrLen (names [ii]) + 1;
	  new_names [ii] = (char*) calloc (len, sizeof (char));
	  ProWstringToString (new_names [ii], names [ii]);
<a name="anchor-276"></a>	  new_labels [ii] = (wchar_t*) calloc (len,  sizeof (wchar_t));
	  ProUtilWstrcpy (new_labels [ii], names [ii]);
	}
      ProUIRadiogroupNamesSet (GD_UI_MAIN, GD_UI_TOOL_VIEW_CHOICE_M,
			       num_views, new_names);
<a name="anchor-277"></a>      ProUIRadiogroupLabelsSet (GD_UI_MAIN, GD_UI_TOOL_VIEW_CHOICE_M,
			       num_views, new_labels);

      for (ii = 0; ii &lt; num_views; ii++)
	{
<a name="anchor-278"></a>	  free (new_names [ii]);
	  free (new_labels [ii]);
	}
      free (new_names);
      free (new_labels);
<a name="anchor-279"></a>      ProArrayFree ((ProArray*)&amp;names);
    }

}

<a name="anchor-280"></a>/*=============================================================*\
  Function: 	ProTKGDUIDefaultViewCreateAction
  Purpose:	Create Default Views action function
\*=============================================================*/
void  ProTKGDUIDefaultViewCreateAction (char* dialog, char* component, 
<a name="anchor-281"></a>			      ProAppData appdata)
{
    GearParam* g_ptr = (GearParam*)appdata;

    ProUserCreateViewAuto (g_ptr);
<a name="anchor-282"></a>
    ProTKGDUIViewNamesUpdate (g_ptr);
}

/*=============================================================*\
<a name="anchor-283"></a>  Function: 	ProTKGDUIViewStoreAction
  Purpose:	Save View action function
\*=============================================================*/
void  ProTKGDUIViewStoreAction (char* dialog, char* component, 
			      ProAppData appdata)
<a name="anchor-284"></a>{
    GearParam* g_ptr = (GearParam*)appdata;

    ProUserCreateViewManual (g_ptr);

<a name="anchor-285"></a>    ProTKGDUIViewNamesUpdate (g_ptr);
}

/*=============================================================*\
  Function: 	ProUserNewgearUI
<a name="anchor-286"></a>  Purpose:	Initialize and launch the Gear Design dialog
\*=============================================================*/
int ProUserNewgearUI()
{
  ProError err;
<a name="anchor-287"></a>  int ui_status;
  GearParam *g_ptr;
  ProMdl model;
  
  err = ProMdlCurrentGet(&amp;model);
<a name="anchor-288"></a>  if (err != PRO_TK_NO_ERROR)
    return (-1);
  
  g_ptr = (GearParam*)calloc(1, sizeof(GearParam));
  memset (g_ptr, '\0', sizeof (GearParam));
<a name="anchor-289"></a>  g_ptr->model = (ProPart)model;
  g_ptr->current_step = PTK_GD_DATUM;
  
  ProUserAssignParamDef (g_ptr);

<a name="anchor-290"></a>/*-----------------------------------------------------------------*\
    Collect information about created features
\*-----------------------------------------------------------------*/
  if (ProUserCheckFeatures(g_ptr)!=PRO_TK_NO_ERROR)
    {
<a name="anchor-291"></a>      ProMessageDisplay(MSGFIL, &quot;USER Error while check Gear Design&quot;);
      return (-1);
    }	

  err = ProUIDialogCreate (GD_UI_MAIN, GD_UI_MAIN);
<a name="anchor-292"></a>
  if (err != PRO_TK_NO_ERROR)
    return PRO_TK_GENERAL_ERROR;
  
  /* UI Initialization */
<a name="anchor-293"></a>
  err = ProUIDialogCloseActionSet (GD_UI_MAIN, 
				   (ProUIAction)ProTKGDUICloseAction, NULL);

  /* Close actions */
<a name="anchor-294"></a>  err = ProUIPushbuttonActivateActionSet (GD_UI_MAIN, GD_UI_CLOSEBTN,
				       (ProUIAction)ProTKGDUICloseAction, NULL);
  
  err = ProUIPushbuttonActivateActionSet (GD_UI_MAIN, GD_UI_CLOSEBTN_M,
				       (ProUIAction)ProTKGDUICloseAction, NULL);
<a name="anchor-295"></a>
  /* Load actions */
  err = ProUIPushbuttonActivateActionSet (GD_UI_MAIN, GD_UI_LOADBTN_M,
					  (ProUIAction)ProTKGDUILoadParamsAction, g_ptr);

<a name="anchor-296"></a>
  err = ProUIPushbuttonActivateActionSet (GD_UI_MAIN, GD_UI_LOADBTN_RMB,
					  (ProUIAction)ProTKGDUILoadParamsAction, g_ptr);


<a name="anchor-297"></a>
  /* Toggle state action */

  err = ProUIRadiogroupSelectActionSet (GD_UI_MAIN, GD_UI_GEARTYPE_GROUP_M,
					(ProUIAction)ProTKGDUIToggleTypeAction, g_ptr);
<a name="anchor-298"></a>
  err = ProUIRadiogroupSelectActionSet (GD_UI_MAIN, GD_UI_GEARTYPE_GROUP_RMB,
					(ProUIAction)ProTKGDUIToggleTypeAction, g_ptr);


<a name="anchor-299"></a>  /* Create action */
  err = ProUIPushbuttonActivateActionSet (GD_UI_MAIN, GD_UI_CREATEBTN,
				       (ProUIAction)ProTKGDUICreateAction, 
					  g_ptr);

<a name="anchor-300"></a>  /* Checkbutton actions */
  err = ProUICheckbuttonActivateActionSet (GD_UI_MAIN, GD_UI_INCLUDE_KEYWAY,
					   (ProUIAction)ProTKGDUIIncludeKeywayAction, g_ptr);

  err = ProUICheckbuttonActivateActionSet (GD_UI_MAIN, GD_UI_INCLUDE_KEY,
<a name="anchor-301"></a>					   (ProUIAction)ProTKGDUIIncludeKeyAction, g_ptr);

  err = ProUICheckbuttonActivateActionSet (GD_UI_MAIN, GD_UI_INCLUDE_BN,
					   (ProUIAction)ProTKGDUIIncludeBacknotchAction, g_ptr);

<a name="anchor-302"></a>  /* Input actions */
  err = ProUIInputpanelInputActionSet (GD_UI_MAIN, GD_UI_GEARDISK_W_INPUT,
				       (ProUIAction)ProTKGDUIDiskInputAction,
				       g_ptr);

<a name="anchor-303"></a>  err = ProUIInputpanelInputActionSet (GD_UI_MAIN, GD_UI_GEARDISK_D_INPUT,
				       (ProUIAction)ProTKGDUIDiskInputAction,
				       g_ptr);
  
  err = ProUIInputpanelInputActionSet (GD_UI_MAIN, GD_UI_HELIX_ANGLE,
<a name="anchor-304"></a>				       (ProUIAction)ProTKGDUIDiskInputAction,
				       g_ptr);

  err = ProUIInputpanelInputActionSet (GD_UI_MAIN, GD_UI_GEARHOLE_D_INPUT,
				       (ProUIAction)ProTKGDUIHoleInputAction,
<a name="anchor-305"></a>				       g_ptr);
				       

  err = ProUIInputpanelInputActionSet (GD_UI_MAIN, GD_UI_TOOTH_P1_INPUT,
				       (ProUIAction)ProTKGDUITeethInputAction,
<a name="anchor-306"></a>				       g_ptr);

  err = ProUIInputpanelInputActionSet (GD_UI_MAIN, GD_UI_GEARHUB_D_INPUT,
				       (ProUIAction)ProTKGDUIHubInputAction,
				       g_ptr);
<a name="anchor-307"></a>
  err = ProUIInputpanelInputActionSet (GD_UI_MAIN, GD_UI_GEARHUB_T_INPUT,
				       (ProUIAction)ProTKGDUIHubInputAction,
				       g_ptr);

<a name="anchor-308"></a>  err = ProUIInputpanelInputActionSet (GD_UI_MAIN, GD_UI_BP_D_INPUT,
				       (ProUIAction)ProTKGDUIBackplateInputAction,
				       g_ptr);

  err = ProUIInputpanelInputActionSet (GD_UI_MAIN, GD_UI_BP_T_INPUT,
<a name="anchor-309"></a>				       (ProUIAction)ProTKGDUIBackplateInputAction,
				       g_ptr);

  err = ProUIInputpanelInputActionSet (GD_UI_MAIN, GD_UI_TOOTH_PRESSURE_ANGLE,
				       (ProUIAction)ProTKGDUITeethInputAction,
<a name="anchor-310"></a>				       g_ptr);

  err = ProUIInputpanelInputActionSet (GD_UI_MAIN, GD_UI_TOOTH_INNER_SURF_INPUT,
				       (ProUIAction)ProTKGDUITeethInputAction,
				       g_ptr);
<a name="anchor-311"></a>
  err = ProUISpinboxUpdateActionSet (GD_UI_MAIN, GD_UI_N_TEETH_SPINBOX,
				     (ProUIAction)ProTKGDUITeethUpdateAction,
				     g_ptr);

<a name="anchor-312"></a>  
  
    /* Update table */
  ProTKGDUIStatusTableInit (g_ptr);

<a name="anchor-313"></a>  err = ProUITableSelectActionSet (GD_UI_MAIN, GD_UI_STATUS_TABLE,
				     (ProUIAction)ProTKGDUITableSelectAction,
				     g_ptr);

  ProTKGDUIDatumUIUpdate (g_ptr);
<a name="anchor-314"></a>  ProTKGDUIDiskUIUpdate (g_ptr);
  ProTKGDUIHoleUIUpdate (g_ptr);
  ProTKGDUIHubUIUpdate (g_ptr);
  ProTKGDUIBackplateUIUpdate (g_ptr);
  ProTKGDUITeethUIUpdate (g_ptr);
<a name="anchor-315"></a>
  /* Tools actions */
  err = ProUIPushbuttonActivateActionSet (GD_UI_MAIN, GD_UI_TOOL_DELETE_M,
				     (ProUIAction)ProTKGDUIDeleteAction,
				     g_ptr);
<a name="anchor-316"></a>
  err = ProUIPushbuttonActivateActionSet (GD_UI_MAIN, GD_UI_TOOL_MODIFY_M,
				     (ProUIAction)ProTKGDUIModifyAction,
				     g_ptr);

<a name="anchor-317"></a>  err = ProUIPushbuttonActivateActionSet (GD_UI_MAIN, GD_UI_TOOL_REGENERATE_M,
				     (ProUIAction)ProTKGDUIRegenerateAction,
				     g_ptr);

  err = ProUIPushbuttonActivateActionSet (GD_UI_MAIN, GD_UI_TOOL_MATERIAL_M,
<a name="anchor-318"></a>				     (ProUIAction)ProTKGDUIMaterialAction,
				     g_ptr);

  ProTKGDUIViewNamesUpdate (g_ptr);

<a name="anchor-319"></a>  err = ProUIRadiogroupSelectActionSet (GD_UI_MAIN, GD_UI_TOOL_VIEW_CHOICE_M,
				     (ProUIAction)ProTKGDUIViewSelectAction,
				     g_ptr);

  err = ProUIPushbuttonActivateActionSet (GD_UI_MAIN, 
<a name="anchor-320"></a>					  GD_UI_TOOL_VIEW_DEFAULTCREATE_M,
					  (ProUIAction)ProTKGDUIDefaultViewCreateAction,
					  g_ptr);

  err = ProUIPushbuttonActivateActionSet (GD_UI_MAIN, GD_UI_TOOL_VIEW_STORE_M,
<a name="anchor-321"></a>				     (ProUIAction)ProTKGDUIViewStoreAction,
				     g_ptr);

  /* Popup menu */
  err = ProUIDialogPopupmenuSet (GD_UI_MAIN, GD_UI_MENUPANE_RMB);
<a name="anchor-322"></a>

  err = ProUIDialogActivate (GD_UI_MAIN, &amp;ui_status);
  
  if (err != PRO_TK_NO_ERROR)
<a name="anchor-323"></a>    return PRO_TK_GENERAL_ERROR;

  err = ProUIDialogDestroy (GD_UI_MAIN);

  free (g_ptr);
<a name="anchor-324"></a>
  return PRO_TK_NO_ERROR;
}
</pre>
</body>
</html>
